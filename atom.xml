<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Stdio&#39;s Blog</title>
  <subtitle>随便写写</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="//blog.stdioa.com/"/>
  <updated>2016-11-08T14:12:03.796Z</updated>
  <id>//blog.stdioa.com/</id>
  
  <author>
    <name>David Dai</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>解决 MySQL 编码问题</title>
    <link href="//blog.stdioa.com/2016/05/django-mysql-charset-problem/"/>
    <id>//blog.stdioa.com/2016/05/django-mysql-charset-problem/</id>
    <published>2016-05-09T01:40:46.000Z</published>
    <updated>2016-11-08T14:12:03.796Z</updated>
    
    <content type="html"><![CDATA[<p>很久以前写了一个 Django 项目，数据库用的 MySQL. 很久没用，后来发现 MySQL 编码设置有问题，导致中文全部变成了问号。</p>
<a id="more"></a>
<h1 id="1-mysql">1. 设置 MySQL 服务端默认字符集</h1>
<p>在 <code>my.cnf</code> 中设置默认字符集：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[mysqld]</div><div class="line">character-set-server=utf8</div></pre></td></tr></table></figure>
<p>同时，可以设置 MySQL 客户端的默认字符集：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[mysql]</div><div class="line">character-set-default=utf-8</div></pre></td></tr></table></figure>
<p>配置完成后，重启 MySQL 服务，输入 <code>SHOW VARIABLES LIKE '%CHAR';</code> 检查字符集是否正确。</p>
<h1 id="2">2. 手动设置数据库编码</h1>
<p>修改默认编码其实是没用的😂，还需要手动设置数据库编码，而数据库编码需要在建立时指定，所以…真是一个悲伤的故事😢（反正我的服务也没人用</p>
<p>重新建立数据库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">DROP DATABASE spaste;</div><div class="line">CREATE DATABASE spaste DEFAULT CHARACTER SET utf8;</div></pre></td></tr></table></figure>
<p>重建数据库后，输入 <code>python manager.py migrate</code> 重新迁移数据库。</p>
<h1 id="3">3. 参考资料</h1>
<ol>
<li><a href="https://dev.mysql.com/doc/refman/5.7/en/charset-applications.html" target="_blank" rel="external">Configuring the Character Set and Collation for Applications - MySQL 5.7 Reference Manual</a></li>
<li><a href="http://shikezhi.com/html/2015/mysql_0827/204288.html" target="_blank" rel="external">django 解决 mysql 数据库输入中文乱码问题</a></li>
</ol>
<h1 id="4">4. 后记</h1>
<p>好短的一篇文章…</p>
<p>最近在爬 B 站用户的公开用户数据，数据库用了 MongoDB, 爬完以后好好玩一玩😳<br>
B 站基佬好多啊_(:зゝ∠)_</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;很久以前写了一个 Django 项目，数据库用的 MySQL. 很久没用，后来发现 MySQL 编码设置有问题，导致中文全部变成了问号。&lt;/p&gt;
    
    </summary>
    
      <category term="开发" scheme="//blog.stdioa.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="MySQL" scheme="//blog.stdioa.com/tags/MySQL/"/>
    
      <category term="Django" scheme="//blog.stdioa.com/tags/Django/"/>
    
  </entry>
  
  <entry>
    <title>第一届 NUAACTF 非官方 Writeup</title>
    <link href="//blog.stdioa.com/2016/04/nuaactf-unofficial-writeup/"/>
    <id>//blog.stdioa.com/2016/04/nuaactf-unofficial-writeup/</id>
    <published>2016-04-25T04:01:04.000Z</published>
    <updated>2016-11-08T13:48:35.546Z</updated>
    
    <content type="html"><![CDATA[<p>学校组织了第一届 NUAACTF，参加去玩玩，开开脑洞😂，嗯，还蛮好玩的~</p>
<a id="more"></a>
<h1 id="web-0">Web 0</h1>
<p><strong>huan’ying’lai’dao</strong></p>
<p>签到题，F12 即可得到 flag.
Flag 藏在页面的某个 <code>js</code> 文件里，用 jsfuck 混淆了。</p>
<h1 id="web-1">Web 1</h1>
<p><strong>百度一下，你就知道</strong></p>
<p>题目貌似改过一回。</p>
<p>改之前直接点击网页上的一个链接，跳转到某个网页，源代码里面有一段 php，具体内容不记得了，里面
有一串 MD5 <code>095a655fc809cbbdffa207717a5233f5</code>. Google 一下找到某白菜的博客，得到原文 <code>bnVhYWN0ZiU3Qi93ZWIyL2NlYmE2ZmJiZjBlZGU0MzI1MjY0MWNkMzM2ZTM2YTAzJTdE</code>.<br>
看起来像 <code>Base64</code>，于是 decode 一下，然后 <code>decodeURIComponents</code> 得到 flag.</p>
<p>后来题目改了，直接按照题目要求去百度就能直接找到某白菜的博客。</p>
<h1 id="web-2">Web 2</h1>
<p><strong>不是 bug 是 feature</strong></p>
<p>Web 2 的入口点在 Web 1 的 flag 里。进去以后会跳转到某个 php, 然而某白菜又把 php 源码写进去了，思路跟上个题好像一样，也是去百度一下 MD5 得到密码，添加 <code>GET</code> 参数即可拿到 flag.</p>
<h1 id="web-3">Web 3</h1>
<p><strong>笨笨的程序猿</strong></p>
<p>Web 3 的入口点在 Web 2 的 flag 里。进去以后跳转到某 php, 里面只有一个登录表单。看起来像是 SQL 注入，就用 <code>sqlmap</code> 扫了一下，把表 dump 出来，发现有两个账户 admin 和 user，密码都是一坨看起来什么都不像的东西，然后线索就断了。<br>
最后一个小时决定手动注入一下，然而并不怎么会 SQL 注入于是就找了几篇博客来看。注入了半天密码框均无果，最后试了一下注入用户名输入框 <code>admin' or '1'='1</code>，成功登录。<br>
登录以后 flag 一闪而过，本来想截屏然而懒得截了就抓了包，拿到 flag.</p>
<h1 id="web-4">Web 4 (未解出)</h1>
<p><strong>你从哪里来，我的朋友。</strong></p>
<p>Web 3 成功登录后就跳转到 Web 4，网页写着&quot;0nly welc0me pe0ple who c0me from <a href="http://cs.nuaa.edu.cn" target="_blank" rel="external">http://cs.nuaa.edu.cn</a> &quot;。结合“你从哪里来”，想到了请求来源，但是我只想到了 <code>Referer</code>, 修改后无果。<br>
比赛结束后听说要改 <code>Origin</code> 和 <code>X-Forwarded-For</code>, 然而改了也没做出来，不知道哪里出了问题。</p>
<h1 id="rev-1">Rev 1</h1>
<p><strong>曾老师的 Android 课</strong></p>
<p>把 apk 下载下来，用 <code>jd-gui</code> 打开，一阵乱翻以后发现 flag 藏在 <code>MainActivity.class</code> 里。</p>
<h1 id="rev-2">Rev 2 (未解出)</h1>
<p><strong>奇妙的声音</strong></p>
<p>又看见安卓了，下下来以后一阵乱翻，没有头绪。</p>
<p>刚才看了别人的题解，发现 flag 在资源目录里面。<br>
拿出来 <code>res/raw/sound.wav</code>, 用随便什么鬼打开（来之前见识过这个脑洞，专门准备的 Sonic Visualiser, 然而卡住了没有用上），发现里面有四个声道，下面两个声道像是个方波。</p>
<p><img src="/pics/nuaactf/rev2.png" alt="Rev 2"></p>
<p>然后一点一点数 01 数出来，得到：</p>
<blockquote>
<p>01101110
01110101
01100001
01100001
01100011
01110100
01100110
01111011
01110011
01101000
00110000
01110010
01110100
01011111
01100110
00110001
01000001
01100111</p>
</blockquote>
<p>数格子数的眼都要花了…<br>
每一行 8 位二进制转 ASCII 码，得到 flag <code>nuaactf{sh0rt_f1Ag</code>, 少了一个右括号😂<br>
真是幸亏 flag 短…</p>
<p>顺便说一句，那个音频真好听，听说是锤子手机的默认铃声😳</p>
<h1 id="rev-3">Rev 3</h1>
<p><strong>不喜欢写界面的白菜哥</strong></p>
<p><code>.NET</code> 逆向，直接拖到 IDA 里面，一阵乱翻，翻到了三段 base64 和一个摩尔斯电码表。把三段 base64 拼起来以后 decode, 得到一段摩尔斯电码 <code>-. ..- .- .- -.-. - ..-. 2D3f ... .- .--. .--. -.-- -.-. .-. .- -.-. -....- .---- -. --. -.-. ... ... .- .-. .--. -...--.-</code> (2D3f 是什么鬼😂)，解码后得到 flag <code>NUAACTF{SAPPYCRACK1NGCSSARP}</code>，放到源程序里面，显示 flag 正确。</p>
<p>然后，提交以后说 flag 不对！<br>
为什么 flag 不是 Happy Cracking CSharp? 看了半天，又交了半天的 flag，没找出问题。后来发现程序编码表里面 H 和 S 的编码一样😂 所以里面所有的 S 换成 H，源程序都会提示 flag 正确…<br>
把 H 和 S 转换，一个一个试，最后试出来 flag 是 <code>NUAACTF{HAPPYCRACK1NGCHHARP}</code>，也是醉人。</p>
<h1 id="pwn-1">Pwn 1</h1>
<p><strong>乱码！乱码！</strong></p>
<p>签到题。下载下来一个 txt，打开以后发现是 jsfuck，放到浏览器里运行得到 flag.</p>
<h1 id="pwn-2">Pwn 2 （未解出）</h1>
<p><strong>回家的路</strong></p>
<p>CTF 竞赛考了算法…最短路…真是醉醉哒。<br>
一开始没有细想，瞎写了一个深度优先搜索，出来好多解，然而没有一个是对的，也是悲催。<br>
到最后也没有做。</p>
<h1 id="misc-1">Misc 1</h1>
<p><strong>奇怪的压缩包</strong></p>
<p>嘛，隐写的题都蛮好玩哒😜</p>
<p><a href="/pics/nuaactf/misc1.rar">misc1.rar</a> 下载下来后无法打开，<code>file</code> 一下发现是个 PNG，改拓展名后打开，得到 flag。这个也算签到题吧。</p>
<h1 id="misc-2">Misc 2</h1>
<p><strong>奇怪的图片</strong></p>
<p><img src="/pics/nuaactf/misc2.png" alt="misc2.png"></p>
<p>下载 <code>misc2.png</code>, <code>pngcheck</code> 提示 <code>additional data after IEND chunk</code>, 看来最后一块后面还有东西，用记事本打开，发现文件最后用明文写着 key.</p>
<p>刚刚在文件末尾发现了一个文件头 <code>PK\x03\x04</code>, 觉得应该是个 zip 文件，<code>binwalk</code> 一下然后用 <code>dd</code> 分开，得到一个 zip 文件，解压后得到 flag. 这应该是这个题的标准做法吧，只是为什么做 zip 文件的时候没有压缩🌚</p>
<h1 id="misc-3">Misc 3</h1>
<p><strong>更奇怪的图片</strong>（你们这起的都是什么名字）</p>
<p><img src="/pics/nuaactf/misc3.png" alt="misc3.png"></p>
<p>下载下来（听说这是舰娘？），<code>pngcheck</code> 没有错误，卡了一会。后来用 PS 打开，把色阶拉低，发现图的左下角有个二维码，扫码得 <code>QlpoOTFBWSZTWXhAk1kAAAtfgAAQIABgAAgAAACvIbYKIAAigNHqNGmnqFMJpoDTEO0CXcIvl9SeOAB3axLQYn4u5IpwoSDwgSay</code>.<br>
解码后发现是乱码，不知道怎么做了，卡了很久😷 比赛的最后一个小时看见了解码后字符串开头的 BZ，突然意识到这可能是个文件头，于是将解码后的内容写入文件，<code>file</code> 一下发现果然是个 <code>bz</code> 压缩文件，解压后得到 flag.</p>
<h1 id="misc-4">Misc 4 （未解出）</h1>
<p><strong>讨厌的 APP</strong></p>
<p>觅动校园什么鬼？！</p>
<h1 id="">总结</h1>
<p>比赛五个小时，解了 10 道题，前半小时解出来 5 道，后面各种卡，最后一个小时脑洞大开又解出来 3 道题😂
CTF 真好玩，考到了各种姿势各种脑洞，还是蛮有意思哒~<br>
然而五个小时的比赛真的太累了…血的教训，下次题目做不出来还是要跑出去歇一会再回来做_(:зゝ∠)_</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;学校组织了第一届 NUAACTF，参加去玩玩，开开脑洞😂，嗯，还蛮好玩的~&lt;/p&gt;
    
    </summary>
    
      <category term="乱七八糟" scheme="//blog.stdioa.com/categories/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F/"/>
    
    
      <category term="CTF" scheme="//blog.stdioa.com/tags/CTF/"/>
    
      <category term="脑洞" scheme="//blog.stdioa.com/tags/%E8%84%91%E6%B4%9E/"/>
    
      <category term="Python" scheme="//blog.stdioa.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode 数据库题目解答</title>
    <link href="//blog.stdioa.com/2016/04/leetcode-database-solutions/"/>
    <id>//blog.stdioa.com/2016/04/leetcode-database-solutions/</id>
    <published>2016-04-06T08:02:00.000Z</published>
    <updated>2016-11-08T13:48:35.544Z</updated>
    
    <content type="html"><![CDATA[<p>前两天重刷了《SQL必知必会》，昨天想到了 LeetCode，于是去刷了几道数据库的题目，开了不少脑洞。</p>
<a id="more"></a>
<p>今天把答案整理一下。喔，题库在<a href="https://leetcode.com/problemset/database/" target="_blank" rel="external">这里</a>。</p>
<h1 id="175-combine-two-tables"><a href="https://leetcode.com/problems/combine-two-tables/" target="_blank" rel="external">175. Combine Two Tables</a></h1>
<p>样例中有些人的 <code>PersonId</code> 无法在 <code>Address</code> 表中找到，所以使用 <code>LEFT JOIN</code>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> FirstName, LastName, City, State</div><div class="line"><span class="keyword">FROM</span> Person</div><div class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Address</div><div class="line"><span class="keyword">ON</span> Person.PersonId = Address.PersonId;</div></pre></td></tr></table></figure>
<h1 id="176-second-highest-salary"><a href="https://leetcode.com/problems/second-highest-salary/" target="_blank" rel="external">176. Second Highest Salary</a></h1>
<p><code>UNION</code> 查询，在结果的最后添加一个 <code>NULL</code>, 若不存在第二高的薪水则会选择 <code>NULL</code>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> Salary <span class="keyword">FROM</span> Employee</div><div class="line"><span class="keyword">UNION</span></div><div class="line"><span class="keyword">SELECT</span> <span class="literal">NULL</span></div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></div><div class="line"><span class="keyword">LIMIT</span> <span class="number">1</span>, <span class="number">1</span>;</div></pre></td></tr></table></figure>
<h1 id="177-nth-highest-salary"><a href="https://leetcode.com/problems/nth-highest-salary/" target="_blank" rel="external">177. Nth Highest Salary</a></h1>
<p>这个不知道为什么不可以用 <code>LIMIT 1, N-1</code>，所以用了 <code>IF</code> 函数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getNthHighestSalary(N <span class="built_in">INT</span>) <span class="keyword">RETURNS</span> <span class="built_in">INT</span></div><div class="line"><span class="keyword">BEGIN</span></div><div class="line">  <span class="keyword">RETURN</span> (</div><div class="line">      # Write your MySQL <span class="keyword">query</span> <span class="keyword">statement</span> below</div><div class="line">      <span class="keyword">SELECT</span> <span class="keyword">IF</span>(<span class="keyword">COUNT</span>(*) &gt;= N, <span class="keyword">MIN</span>(rank.Salary), <span class="literal">NULL</span>)</div><div class="line">      <span class="keyword">FROM</span> (</div><div class="line">        <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Salary</div><div class="line">        <span class="keyword">FROM</span> Employee</div><div class="line">        <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></div><div class="line">        <span class="keyword">LIMIT</span> N</div><div class="line">    ) <span class="keyword">AS</span> <span class="keyword">rank</span></div><div class="line">  );</div><div class="line"><span class="keyword">END</span></div></pre></td></tr></table></figure>
<h1 id="178-rank-scores"><a href="https://leetcode.com/problems/rank-scores/" target="_blank" rel="external">178. Rank Scores</a></h1>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> Score, (</div><div class="line">    <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> Score)</div><div class="line">    <span class="keyword">FROM</span> Scores <span class="keyword">AS</span> c</div><div class="line">    <span class="keyword">WHERE</span> o.Score &lt;= c.Score      # 统计比已选分数小的分数个数</div><div class="line">) <span class="keyword">AS</span> <span class="keyword">Rank</span></div><div class="line"><span class="keyword">FROM</span> Scores <span class="keyword">AS</span> o</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Score <span class="keyword">DESC</span>;</div></pre></td></tr></table></figure>
<h1 id="180-consecutive-numbers"><a href="https://leetcode.com/problems/consecutive-numbers/" target="_blank" rel="external">180. Consecutive Numbers</a></h1>
<p>暴力查询😂</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> l1.Num <span class="keyword">AS</span> ConsecutiveNums</div><div class="line"><span class="keyword">FROM</span> <span class="keyword">Logs</span> <span class="keyword">AS</span> l1, <span class="keyword">Logs</span> <span class="keyword">AS</span> l2, <span class="keyword">Logs</span> <span class="keyword">AS</span> l3</div><div class="line"><span class="keyword">WHERE</span> l1.Id+<span class="number">1</span> = l2.Id <span class="keyword">AND</span> l2.Id+<span class="number">1</span> = l3.Id</div><div class="line">  <span class="keyword">AND</span> l1.Num = l2.Num <span class="keyword">AND</span> l2.Num = l3.Num;</div></pre></td></tr></table></figure>
<h1 id="181-employees-earning-more-than-their-managers"><a href="https://leetcode.com/problems/employees-earning-more-than-their-managers/" target="_blank" rel="external">181. Employees Earning More Than Their Managers</a></h1>
<p>选择雇员，根据 <code>ManagerId</code> 找到雇员上司的薪水，然后进行比较即可。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">Name</span></div><div class="line"><span class="keyword">FROM</span> Employee</div><div class="line"><span class="keyword">WHERE</span> Salary &gt; (</div><div class="line">          <span class="keyword">SELECT</span> Salary</div><div class="line">          <span class="keyword">FROM</span> Employee <span class="keyword">AS</span> e</div><div class="line">          <span class="keyword">WHERE</span> e.id = Employee.ManagerId</div><div class="line">        );</div></pre></td></tr></table></figure>
<h1 id="182-duplicate-emails"><a href="https://leetcode.com/problems/duplicate-emails/" target="_blank" rel="external">182. Duplicate Emails</a></h1>
<p>按 <code>Email</code> 字段进行分类，使用 <code>HAVING</code> 筛选出相同 <code>Email</code> 数量大于 1 的项。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> Email <span class="keyword">FROM</span> Person</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Email</div><div class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(Email)&gt;<span class="number">1</span>;</div></pre></td></tr></table></figure>
<h1 id="183-customers-who-never-order"><a href="https://leetcode.com/problems/customers-who-never-order/" target="_blank" rel="external">183. Customers Who Never Order</a></h1>
<p>这个也是直接查询…</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> c.Name <span class="keyword">AS</span> Customers</div><div class="line"><span class="keyword">FROM</span> Customers <span class="keyword">AS</span> c</div><div class="line"><span class="keyword">WHERE</span> (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</div><div class="line">       <span class="keyword">FROM</span> Orders</div><div class="line">       <span class="keyword">WHERE</span> c.id = Orders.CustomerId) = <span class="number">0</span>;</div></pre></td></tr></table></figure>
<h1 id="184-department-highest-salary"><a href="https://leetcode.com/problems/department-highest-salary/" target="_blank" rel="external">184. Department Highest Salary</a></h1>
<p>基本上就是直接查询，注意 <code>WHERE</code> 语句中判别条件的位置，否则有可能 TLE😂</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> d.Name <span class="keyword">AS</span> Department,</div><div class="line">    e.Name <span class="keyword">AS</span> Employee,</div><div class="line">    e.Salary</div><div class="line"><span class="keyword">FROM</span> Employee <span class="keyword">AS</span> e, Department <span class="keyword">AS</span> d</div><div class="line"><span class="keyword">WHERE</span> e.DepartmentId = d.Id</div><div class="line">  <span class="keyword">AND</span> e.Salary = (<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(e2.Salary)</div><div class="line">                <span class="keyword">FROM</span> Employee <span class="keyword">AS</span> e2</div><div class="line">                <span class="keyword">WHERE</span> e.DepartmentId = e2.DepartmentId);</div></pre></td></tr></table></figure>
<h1 id="185-department-top-three-salaries"><a href="https://leetcode.com/problems/department-top-three-salaries/" target="_blank" rel="external">185. Department Top Three Salaries</a></h1>
<p>输出每个部门薪资最高的三个人。这个题里有个坑，如果两个人薪资相同，那么这两个人并列，都要输出。并且如果四个人的薪资为 3 2 2 1， 薪资为 1 的那个人排第 3 😂</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> d.Name <span class="keyword">AS</span> Department,</div><div class="line">    e.Name <span class="keyword">AS</span> Employee,</div><div class="line">    e.Salary</div><div class="line"><span class="keyword">FROM</span> Employee <span class="keyword">AS</span> e, Department <span class="keyword">AS</span> d</div><div class="line"><span class="keyword">WHERE</span> e.DepartmentId = d.Id</div><div class="line">  <span class="keyword">AND</span> (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> e2.Salary)             # 排序时允许并列</div><div class="line">            <span class="keyword">FROM</span> Employee <span class="keyword">AS</span> e2</div><div class="line">            <span class="keyword">WHERE</span> e.DepartmentId = e2.DepartmentId</div><div class="line">              <span class="keyword">AND</span> e.Salary &lt; e2.Salary) &lt; <span class="number">3</span>         # 比该雇员工资高的人少于三个</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Department, Salary <span class="keyword">DESC</span>;</div></pre></td></tr></table></figure>
<h1 id="196-delete-duplicate-emails"><a href="https://leetcode.com/problems/delete-duplicate-emails/" target="_blank" rel="external">196. Delete Duplicate Emails</a></h1>
<p>MySQL 不允许在删除时依据待删除的表进行筛选 (You can’t specify target table’Person’ for update in FROM clause), 所以要绕一下。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"># 错的！！</div><div class="line">DELETE FROM Person</div><div class="line">WHERE Id IN (SELECT p2.Id</div><div class="line">             FROM Person AS p1, Person AS p2</div><div class="line">             WHERE p1.Email = p2.Email</div><div class="line">               AND p1.Id &lt; p2.Id</div><div class="line">            );</div><div class="line"></div><div class="line">DELETE FROM Person</div><div class="line">WHERE Id IN (SELECT * FROM(                         # 绕一下，先挑出所有满足要求的 ID 构成一个表，再从这个表中选 Id 进行删除</div><div class="line">                    SELECT p2.Id</div><div class="line">                    FROM Person AS p1, Person AS p2</div><div class="line">                    WHERE p1.Email = p2.Email</div><div class="line">                      AND p1.Id &lt; p2.Id) AS temp</div><div class="line">                      );</div></pre></td></tr></table></figure>
<h1 id="197-rising-temperature"><a href="https://leetcode.com/problems/rising-temperature/" target="_blank" rel="external">197. Rising Temperature</a></h1>
<p>主要考 <code>MySQL</code> 的日期操作函数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> w1.Id <span class="keyword">AS</span> <span class="keyword">Id</span></div><div class="line"><span class="keyword">FROM</span> Weather <span class="keyword">AS</span> w1, Weather <span class="keyword">AS</span> w2</div><div class="line"><span class="keyword">WHERE</span> <span class="keyword">datediff</span>(w1.Date, w2.Date) = <span class="number">1</span></div><div class="line">  <span class="keyword">AND</span> w1.Temperature &gt; w2.Temperature;</div></pre></td></tr></table></figure>
<h1 id="262-trips-and-users"><a href="https://leetcode.com/problems/trips-and-users/" target="_blank" rel="external">262. Trips and Users</a></h1>
<p>太乱了，没做😥</p>
<h1 id="">后记</h1>
<p>昨天花了半天写完这些题，写到最后都不知道自己在写什么了😂不过还是掌握了不少的 SQL 查询技巧，比如 <code>UNION SELECT NULL</code> 等等。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;前两天重刷了《SQL必知必会》，昨天想到了 LeetCode，于是去刷了几道数据库的题目，开了不少脑洞。&lt;/p&gt;
    
    </summary>
    
      <category term="LeetCode" scheme="//blog.stdioa.com/categories/LeetCode/"/>
    
    
      <category term="LeetCode" scheme="//blog.stdioa.com/tags/LeetCode/"/>
    
      <category term="数据库" scheme="//blog.stdioa.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="SQL" scheme="//blog.stdioa.com/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>随手记之Vue.js</title>
    <link href="//blog.stdioa.com/2016/03/essay-vue/"/>
    <id>//blog.stdioa.com/2016/03/essay-vue/</id>
    <published>2016-03-28T13:40:03.000Z</published>
    <updated>2016-11-08T13:48:35.501Z</updated>
    
    <content type="html"><![CDATA[<p>之前的那门 JS 和前端课结课了，最后花了一周时间写了一个 project，使用 Vue.js 的一套工具写了一个单页面应用，先将使用到及学到的知识来整理一下。</p>
<a id="more"></a>
<p>想了想，之前自己学习 <code>Vue.js</code> 的时候一直在翻文档，翻到哪些让人眼前一亮的功能时就将它加进自己的项目里，并没有什么系统地进行学习，所以想到哪写到哪好了。前方高乱预警。</p>
<h1 id="1-vuejs">1. Vue.js</h1>
<p>之前用 <code>React</code> 用得有些不爽了所以想换换口味, 于是 用<a href="http://vuejs.org.cn/" target="_blank" rel="external"><code>Vue.js</code></a> 写了一个小应用的前端部分。它的轻量以及MVVM架构让我在两天之内爱上了它，于是决定用它代替 React 去完成 final project 的前端部分。</p>
<p>不知道为什么，我觉得 <code>Vue.js</code> 比 <code>React</code> 更容易上手，所以很快就学会了它。想了想确实不知道该整理一些什么，因为 <a href="http://vuejs.org.cn/guide/" target="_blank" rel="external">Vue 的官方教程</a>写的确实很直白清楚，所以在此不再赘述，有时间的话可能会考虑写一个 Vue 的教程。</p>
<h1 id="2-vue-cli">2. vue-cli</h1>
<p><a href="https://github.com/vuejs/vue-cli" target="_blank" rel="external">vue-cli</a> 是一个 Vue.js 官方提供的脚手架工具，你可以使用它来轻松地构建出一个应用 <code>Vue.js</code> 的工程。官方提供 5 种模板，当然你也可以在 <code>github</code> 上或者本地构建自己的模板然后使用 vue-cli 生成工程。</p>
<p><a href="https://github.com/vuejs/vue-cli#usage" target="_blank" rel="external">具体使用方法</a>：生成一个工程极为简单，只需一两条命令即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ vue init webpack my-project     // 使用 webpack 模板生成工程 my-project</div><div class="line">$ <span class="built_in">cd</span> my-project</div><div class="line">$ npm install</div><div class="line">$ npm run dev</div></pre></td></tr></table></figure>
<p>然后，借助 <code>webpack</code> 与 <code>vue-loader</code>, 你可以将一个 <code>Vue</code> 组件的模板、核心js代码和CSS写在<strong>一个文件里</strong>，甚至还可以使用 <code>CSS</code> 与 <code>HTML</code> 的预处理器，像这样：<br>
<img src="/pics/vue/vue-component-with-pre-processors.png" alt=""><br>
<span style="font-size: 0.75em;">图片来自<a href="http://vuejs.org.cn/guide/application.html" target="_blank" rel="external"> Vue.js 官方教程 - 构建大型应用</a>。</span></p>
<h1 id="3-vue-router">3. Vue-router</h1>
<p><a href="https://github.com/vuejs/vue-router/" target="_blank" rel="external"><code>vue-router</code></a> 是 <code>vue</code> 官方提供的路由模块，可以实现 <code>SPA</code> 中的路由操作。具体文档看<a href="http://vuejs.github.io/vue-router/zh-cn/index.html" target="_blank" rel="external">这里</a>。顺便提一句，<code>vue-router</code> 的中文文档已经过时了。</p>
<h2 id="31">3.1 初始化</h2>
<p>首先使用 <code>npm</code> 安装 <code>vue-router</code>, 然后在程序入口点配置 <code>vue-router</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./components/App'</span>                    <span class="comment">// 程序的核心 Vue 应用</span></div><div class="line"><span class="keyword">import</span> HomePageView <span class="keyword">from</span> <span class="string">'./components/HomePageView'</span>  <span class="comment">// 导入所有的 View 组件</span></div><div class="line"><span class="keyword">import</span> ItemView <span class="keyword">from</span> <span class="string">'./components/ItemView'</span></div><div class="line"></div><div class="line">Vue.use(Router)                                       <span class="comment">// Vue 配置</span></div><div class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> Router()                             <span class="comment">// 生成路由对象</span></div><div class="line">router.map(&#123;                                          <span class="comment">// 配置路由</span></div><div class="line">  <span class="string">'/'</span>: &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'homepage'</span>,</div><div class="line">    <span class="attr">component</span>: HomePageView</div><div class="line">  &#125;,</div><div class="line">  <span class="string">'/home'</span>: &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'homepage'</span>,</div><div class="line">    <span class="attr">component</span>: HomePageView</div><div class="line">  &#125;,</div><div class="line">  <span class="string">'/item/:id'</span>: &#123;                                    <span class="comment">// 支持动态路径</span></div><div class="line">    name: <span class="string">'item'</span>,</div><div class="line">    <span class="attr">component</span>: ItemView</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">router.redirect(&#123;                                   <span class="comment">// 设置重定向选项</span></div><div class="line">  <span class="string">'*'</span>: <span class="string">'/home'</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">router.start(App, <span class="string">'[app]'</span>)                           <span class="comment">// 挂载 Vue 主应用</span></div></pre></td></tr></table></figure>
<p>然后在 <code>App.vue</code> 的 template 中设置 <code>router-view</code>.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">router-view</span></span></div><div class="line">    <span class="attr">keep-alive</span></div><div class="line">    <span class="attr">transition</span>=<span class="string">"fade"</span></div><div class="line">    <span class="attr">transition-mode</span>=<span class="string">"out-in"</span>&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="32-vue-router">3.2 vue-router 的使用</h2>
<p><code>Vue Router</code> 对象被嵌入到每个 <code>vue</code> 组件中，可以在组件中调用 <code>this.$router</code> 来控制 router 对象，如进行页面跳转等。</p>
<p>此外，还可以在页面切换时在组件的 <code>route</code> 配置中使用路由切换钩子控制 <code>vue-router</code>，详情请看<a href="http://vuejs.github.io/vue-router/zh-cn/pipeline/index.html" target="_blank" rel="external">文档</a></p>
<h1 id="4-vuex">4. Vuex</h1>
<p><a href="https://github.com/vuejs/vuex/" target="_blank" rel="external"><code>Vuex</code></a> 是一个借鉴于 <code>Flux</code>，但是专门为 <code>Vue.js</code> 所设计的状态管理方案。<code>Flux</code> 采用了 <code>Action → Dispatcher → Store → View</code> 的状态管理机制，而 <code>Vuex</code> 跟它差不多：Vue 组件调用 action，action dispatches mutation, mutation 改变 store 中的 state，state 改变 View. 下面是 <code>Vuex</code> 的数据流。</p>
<p><img src="/pics/vue/vuex.png" alt="Vuex Data Flow"></p>
<h2 id="41">4.1 使用方法</h2>
<p>程序入口点：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></div><div class="line"></div><div class="line">Vue.use(Vuex)</div></pre></td></tr></table></figure>
<p>主应用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'../store'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  store,                      <span class="comment">// 引用store</span></div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其它组件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  ...,</div><div class="line">  <span class="attr">vuex</span>: &#123;</div><div class="line">    <span class="comment">// 定义 getter 从 store 中获取 state 并注册至应用中</span></div><div class="line">    getters: &#123;</div><div class="line">      <span class="attr">logged_in</span>: <span class="function"><span class="keyword">function</span> (<span class="params">state</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> state.user.logged_in</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// 定义 action, 组件可在自己的函数中调用 action 来 dispatch mutations.</span></div><div class="line">    actions: &#123;</div><div class="line">      <span class="attr">login</span>: <span class="function">(<span class="params">&#123; dispatch &#125;, user</span>) =&gt;</span> &#123;</div><div class="line">        dispatch(<span class="string">'LOGIN'</span>, user)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>关于 store 及 mutation 的定义方式，请参考<a href="http://vuejs.github.io/vuex/en/tutorial.html" target="_blank" rel="external"> Vuex 文档</a>。</p>
<h1 id="5">5. 总结 &amp; 后记</h1>
<p>跟 React 相比，个人感觉 Vue 要更容易上手，易于使用，文档也很清楚（比 Hexo 的高到不知道那里去了，前两天被 Hexo 整疯了必须要黑一下它）；Vue 的一系列工具也很易于使用，与 Vue 整合度高，可以在组件中方便地进行操作。</p>
<p>前端课结课，准备退坑了，过几天可能会学习并整理一些后端的知识。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前的那门 JS 和前端课结课了，最后花了一周时间写了一个 project，使用 Vue.js 的一套工具写了一个单页面应用，先将使用到及学到的知识来整理一下。&lt;/p&gt;
    
    </summary>
    
      <category term="Javascript" scheme="//blog.stdioa.com/categories/Javascript/"/>
    
    
      <category term="前端开发" scheme="//blog.stdioa.com/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
      <category term="Javascript" scheme="//blog.stdioa.com/tags/Javascript/"/>
    
      <category term="node.js" scheme="//blog.stdioa.com/tags/node-js/"/>
    
      <category term="vue.js" scheme="//blog.stdioa.com/tags/vue-js/"/>
    
  </entry>
  
  <entry>
    <title>Atom 浅度体验感受</title>
    <link href="//blog.stdioa.com/2016/03/essay-atom-using-experience/"/>
    <id>//blog.stdioa.com/2016/03/essay-atom-using-experience/</id>
    <published>2016-03-27T02:40:03.000Z</published>
    <updated>2016-11-08T13:48:35.480Z</updated>
    
    <content type="html"><![CDATA[<p>昨天看到了 Atom 官方发布了一篇 <a href="http://flight-manual.atom.io/" target="_blank" rel="external">Atom Flight Manual</a>, 看了两页觉得有些感兴趣所以下了一个体验一下。</p>
<a id="more"></a>
<p>很久以前就听说了 <code>Atom</code> 这款编辑器，Github 宣称它是&quot;A hackable text editor
for the 21st Century&quot;, 有些感兴趣于是就搞了一个内测码下载下来来玩了玩，但是，当时 Atom 的用户体验并不好，加上可以使用的插件少之又少，就放弃了它。昨天从微博上看到了官方的 <a href="http://flight-manual.atom.io/" target="_blank" rel="external">Atom Flight Manual</a>，决定重新体验一下这款所谓“属于 21 世纪的编辑器”。</p>
<p>当然，作为一个使用 Sublime Text 将近 2 年的用户，我肯定会将 Atom 跟 Sublime Text（下称 ST）进行比较咯。</p>
<h1 id="1">1. 第一印象</h1>
<p>一打开Atom界面，整个 UI 还是浓浓的仿 ST 风格，快捷键都基本一样，可能是因为 ST 的 UI 确实很简洁漂亮吧。<br>
不过 ST 是收费的（无期限评估使用也是收费），而 Atom 是免费的，这点要赞一个~当然这根本无法打消暑假购买 ST 授权码的决心。</p>
<h1 id="2">2. 启动速度</h1>
<p>Atom 的启动速度显然跟 ST 没法比。实测在装了 15 个插件以后，Atom 的启动速度要比 ST3 慢 5 倍左右。当然，它的启动速度应该会比装了一堆插件的 ST2 快一点…ST2 的启动速度貌似是历史遗留问题了。</p>
<h1 id="3">3. 用户体验</h1>
<p>感觉 Atom 的用户体验要比上次好的多。</p>
<p>来说一说我看好 Atom 的地方吧。</p>
<ol>
<li>
<p>Web-Based<br>
Atom 编辑器是基于 V8，整个 Atom 编辑页面就是一个网页。不知道为什么，感觉网页对我来说更有亲切感😳，当然这也使得 Atom 更加容易修改，方便了插件的开发。</p>
</li>
<li>
<p>Git Diff &amp; Markdown Preview 集成<br>
Atom 自带了两个插件：<code>Git Diff</code> 和 <code>Markdown Preview</code>.<br>
<code>Git Diff</code> 可以实时显示当前文件的 Git Diff 信息。嗯那个 Git Diff 还是蛮漂亮的~<br>
<img src="/pics/atom/git_diff.jpg" alt="Git Diff"><br>
<code>Markdown Preview</code> 可以提供 Github Markdown 实时预览。然而作为一个可以对 Markdown 进行人肉编译的人，根本不需要这样的插件嗯😂<br>
同时，Atom 还集成了 Git 的常用功能，如当前目录所在 Git 分支。这个功能也要点个赞。</p>
</li>
<li>
<p>Package/Theme 安装及配置<br>
这点上 Atom 做的要比 ST 好得多。Atom 可以在线查看 Package 的 README 信息，每一个 Package 也有其独立的配置页面，不必像 ST 那样直接去修改配置文件。<br>
<img src="/pics/atom/package_settings.jpg" alt="Package Settings"></p>
<p>当然，Atom 自带了一个叫做 <code>apm</code> 的包管理工具，这个就不错评价咯，人家只是浅度使用嘛（傲娇脸</p>
</li>
</ol>
<h1 id="4-hackable">4. Hackable 简单体验——编辑器字体修改</h1>
<p>之前用 ST 的时候为了将 Consolas 和微软雅黑结合起来，着实头疼了好久，到了 Atom 里，打开 Stylesheet 配置文件，一行代码搞定😆</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">atom-text-editor</span> &#123;</div><div class="line">  <span class="attribute">font-family</span>: Consolas, <span class="string">"Microsoft Yahei"</span>, sans-serif;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="5">5. 总结</h1>
<p>Atom 确实比以前好用了很多。我大概不会卸载它，而是把它留在电脑里，等到 ST 用腻了可以换换口味~<br>
然而尝试了 Atom 并更换主题、安装了几个实用的插件以后，我还是跑到 Sublime 那里安装了类似的插件😂</p>
<p>配置后的 Atom:<br>
<img src="/pics/atom/atom_after.jpg" alt="Atom 个性化"><br>
使用 Atom 前的 ST:<br>
<img src="/pics/atom/st_before.jpg" alt="ST 个性化前"><br>
使用 Atom 后，安装了插件<code>Color Highlighter</code>, <code>GitGutter</code> 和 <code>SublimeGit</code>的 ST:<br>
<img src="/pics/atom/st_after.jpg" alt="ST 个性化后"></p>
<p>好吧…我把 ST 配置的像 Atom 了（摊手</p>
<p>完。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;昨天看到了 Atom 官方发布了一篇 &lt;a href=&quot;http://flight-manual.atom.io/&quot;&gt;Atom Flight Manual&lt;/a&gt;, 看了两页觉得有些感兴趣所以下了一个体验一下。&lt;/p&gt;
    
    </summary>
    
      <category term="随笔" scheme="//blog.stdioa.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="Atom" scheme="//blog.stdioa.com/tags/Atom/"/>
    
      <category term="Sublime Text" scheme="//blog.stdioa.com/tags/Sublime-Text/"/>
    
      <category term="文本编辑器" scheme="//blog.stdioa.com/tags/%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8/"/>
    
      <category term="Git" scheme="//blog.stdioa.com/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>Javascript学习总结</title>
    <link href="//blog.stdioa.com/2016/02/learning-javascript/"/>
    <id>//blog.stdioa.com/2016/02/learning-javascript/</id>
    <published>2016-02-24T11:31:42.000Z</published>
    <updated>2016-11-08T13:48:35.510Z</updated>
    
    <content type="html"><![CDATA[<p>从开始写Javascript到现在，已经有一个月了，这一个月学了不少新姿势，随便写写，简单整理一下。</p>
<a id="more"></a>
<h1 id="1-javascript">1. Javascript</h1>
<p>这个没什么好整理的…随便写几条。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> a;                          <span class="comment">// 防止变量作用域提升</span></div><div class="line">    do_something();</div><div class="line">&#125;());</div><div class="line"></div><div class="line">some_list.map(<span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</div><div class="line">        <span class="keyword">this</span>.do_something(obj);</div><div class="line">    &#125;, <span class="keyword">this</span>);                       <span class="comment">// 把this传到map里面的匿名函数中，否则里面的this为undefined</span></div><div class="line"></div><div class="line">setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;, <span class="number">1000</span>);</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;, <span class="number">1000</span>);</div></pre></td></tr></table></figure>
<h1 id="2-jquery">2. jQuery</h1>
<h2 id="21">2.1 选择器</h2>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">"input[type=text]"</span>)   <span class="comment">// 选择属性</span></div><div class="line">$(<span class="string">"ul&gt;li:eq(3)"</span>)        <span class="comment">// 选择第4个li元素</span></div><div class="line">$(<span class="string">"ul&gt;li"</span>).eq(<span class="number">3</span>)        <span class="comment">// 选择所有"ul&gt;li"中的第4个元素（注意与上面那个选择器的不同）</span></div><div class="line">$(<span class="string">"ul&gt;li:even"</span>)         <span class="comment">// 选择所有奇数li元素（odd同理）</span></div></pre></td></tr></table></figure>
<h2 id="22">2.2 杂项</h2>
<p>获取表单内容时，要用<code>$(&quot;...&quot;).val()</code>而不是<code>$(&quot;...&quot;).text()</code>.</p>
<h1 id="3-nodejs">3. Node.js</h1>
<p>不知道写什么，随便写几个好玩的库：</p>
<ul>
<li><code>cheerio</code>, 在服务器端解析html，跟jQuery用法差不多</li>
<li><code>chalk</code>, 输出彩色文字</li>
<li><code>gulp</code>, 流式自动化构建工具，后面细写</li>
</ul>
<h1 id="4-reactjs">4. React.js</h1>
<h2 id="41-jsxbabel">4.1 JSX与Babel</h2>
<p>JSX是一种语言，babel是一种预处理工具。
JSX可以在浏览器中转换为javascript并执行，有两个前提：</p>
<ol>
<li>包含了<code>browser.js</code></li>
<li>script标签的类型为<code>text/babel</code></li>
</ol>
<p>看<a href="https://facebook.github.io/react/docs/getting-started.html" target="_blank" rel="external">这里</a>。</p>
<p>在很久以前，JSX代码转换库包含在React库里，名叫<code>JSXTransformer.js</code>, 那时script标签的类型为<code>text/jsx</code>, 但是后来JSX代码改用babel来转换了，所以script标签的类型也就变为了<code>text/babel</code>, 代码转换库也不再由React提供。</p>
<p>吐槽：最初看tutorial的时候看的<a href="http://reactjs.cn/react/docs/getting-started.html" target="_blank" rel="external">中文页面</a>，这个页面很久很久没有更新过了，很多内容都过时了，在离线转换的时候需要安装包，npm报出一堆<code>package deprecated</code>的信息，整个人一个大写的卧槽。后来看了上面的英文页面才知道<code>JSXTransformer</code>已经不再使用了，现在大家都用<a href="https://babeljs.io/" target="_blank" rel="external">Babel</a>.</p>
<h2 id="42-react">4.2 React</h2>
<ol>
<li>
<p><a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="external">阮一峰大大写的React入门教程</a>很不错，我基本上是看这个入门的。</p>
</li>
<li>
<p>写JSX时，要注意DOM节点的<code>class</code>和<code>for</code>属性要写为<code>className</code>和<code>htmlFor</code>，因为<code>class</code>和<code>for</code>是javascript的关键字。</p>
</li>
<li>
<p>组件的生命周期：看<a href="https://facebook.github.io/react/docs/working-with-the-browser.html#component-lifecycle" target="_blank" rel="external">官方文档</a>，<code>render</code>函数中<strong>不要</strong>改变组件的state，若组件的props改变而需要相应更改state, 则要在<code>componentWillReceiveProps</code>函数中完成state更改。函数执行完后，render函数会被执行，组件重新渲染。</p>
</li>
</ol>
<h1 id="5-gulp">5. gulp</h1>
<h2 id="51">5.1 简介</h2>
<p>流式自动化构建工具，用于各类文件的转换（如jsx→js→min.js），监控文件变化，搭建静态文件服务器等，可以类比为makefile, 拥有种类繁多的插件。</p>
<p><a href="http://gulpjs.com/" target="_blank" rel="external">gulp官网</a>，<a href="http://www.gulpjs.com.cn/" target="_blank" rel="external">中文网，包含中文文档</a>。</p>
<h2 id="52">5.2 操作</h2>
<ul>
<li>
<p><code>gulp.task(name[, deps], fn)</code>, 注册一个任务</p>
<ul>
<li>name: 任务名称</li>
<li>deps: 依赖的前置任务，string[]</li>
<li>fn: 任务函数，在里面写该任务需要完成的具体事项</li>
</ul>
</li>
<li>
<p><code>gulp.src(globs[, options])</code>, 输出一个满足匹配模式的stream, stream可以用pipe连接起来，类比shell的管道<code>|</code>.</p>
</li>
<li>
<p><code>gulp.dest(path[, options])</code>, 将stream写到某个path当中。</p>
</li>
<li>
<p><code>gulp.watch(glob [, opts], tasks)</code> 或 <code>gulp.watch(glob [, opts, cb])</code>, 监控满足匹配模式的文件，若文件变化，则执行某些任务。</p>
</li>
</ul>
<p>直接看一个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'render'</span>, [<span class="string">'array'</span>, <span class="string">'of'</span>, <span class="string">'task'</span>, <span class="string">'names'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    gulp.src(<span class="string">'./client/templates/*.jade'</span>)                               <span class="comment">// 找到原路径所有的jade文件</span></div><div class="line">        .pipe(jade())                                                   <span class="comment">// 渲染模板</span></div><div class="line">        .pipe(gulp.dest(<span class="string">'./build/templates'</span>))                           <span class="comment">// 输出到某目录</span></div><div class="line">        .pipe(minify())                                                 <span class="comment">// minify</span></div><div class="line">        .pipe(gulp.dest(<span class="string">'./build/minified_templates'</span>));                 <span class="comment">// 输出到另一目录</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'watch'</span>, [<span class="string">"compress"</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> watcher = gulp.watch(<span class="string">'./public/src/*.jsx'</span>, [<span class="string">'compress'</span>]);       <span class="comment">// 监控文件，若文件变化则执行compress任务</span></div><div class="line">    watcher.on(<span class="string">'change'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;                             <span class="comment">// 监听change事件</span></div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'File '</span> + event.path + <span class="string">' was '</span> + event.type + <span class="string">', running tasks...'</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h1 id="6-react-reactbabelgulp">6. React工具集成: React+Babel+gulp</h1>
<p>用gulp执行任务，用babel转换JSX.</p>
<h2 id="61-gulp">6.1 gulp</h2>
<p>所需插件:</p>
<ul>
<li>gulp</li>
<li>gulp-babel</li>
<li>gulp-uglify (压缩js文件用，可选)</li>
</ul>
<p>gulpfile:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp  = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> babel = <span class="built_in">require</span>(<span class="string">'gulp-babel'</span>);</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'transform'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./public/src/*.jsx'</span>)</div><div class="line">                .pipe(babel())</div><div class="line">                .pipe(gulp.dest(<span class="string">'./public/build'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">"compress"</span>, [<span class="string">"transform"</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./public/build/!(*.min).js'</span>)</div><div class="line">            .pipe(uglify())</div><div class="line">            .pipe(rename(&#123; <span class="attr">suffix</span>: <span class="string">".min"</span> &#125;))</div><div class="line">            .pipe(gulp.dest(<span class="string">'./public/build'</span>))</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="62-babel">6.2 Babel</h2>
<p>所需插件：</p>
<ul>
<li>babel-preset-es2015</li>
<li>babel-preset-react</li>
</ul>
<p><code>.babelrc</code>文件：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"presets"</span>: [</div><div class="line">        <span class="string">"es2015"</span>,</div><div class="line">        <span class="string">"react"</span></div><div class="line">    ],</div><div class="line">    <span class="attr">"plugins"</span>: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>若在全局安装了<code>babel-cli</code>，则可以用babel命令转换文件：</p>
<ol>
<li>若当前目录存在上述babelrc文件：
执行<code>babel public\src --out-dir public\build</code></li>
<li>若当前目录不存在bebelrc文件：
执行<code>babel --presets react public\src --out-dir public\build</code></li>
</ol>
<h1 id="7-semantic-ui">7. Semantic UI</h1>
<p>超级棒的一个前端组件库，去看<a href="http://www.semantic-ui.cn/" target="_blank" rel="external">文档</a>吧。</p>
<h1 id="8">8. 后记</h1>
<p>终于写完了。</p>
<p>又一个月没有写东西了，代码写了不少，所学到的知识却没有及时整理下来。真是太懒，懒得整理知识。到现在还欠着一篇Django的生产环境配置的文章没写（其实就是一条命令+nginx配置而已），改天补上。</p>
<p>寒假算是荒废过去了，本来能够写更多东西的，却被一些事情打乱了计划。</p>
<p>以前觉得javascript是一门很糟糕的语言，代码写起来很乱，四五层回调看起来头都大了，但真正写了一个月以后感觉舒服了很多，很多代码写起来得心应手。JS的生态也让我很喜欢，各种工具组件层出不穷，使用起来也及其方便。</p>
<p>这一个月所写的js项目：</p>
<ul>
<li><a href="https://github.com/StdioA/carrez" target="_blank" rel="external">carrez</a>
前后端都有，后端Express, 解析html, 前端使用ajax和后端进行信息交互</li>
<li><a href="https://github.com/StdioA/starwars" target="_blank" rel="external">starwars</a>
纯前端项目，使用React, 用了很久的<code>browser.js</code>, 本地工具集成鼓捣了很久才鼓捣明白</li>
<li><a href="https://github.com/StdioA/git_modifier" target="_blank" rel="external">git_modifier</a>
算是半个JS项目（Github告诉我我这是个JS项目，因为JS代码占比最大），后端Flask, 前端React, 说是Web App其实是个本地项目，用来读取及修改本地git repo的commit信息用的，奇怪的需求，写来自己用，方便伪造commit信息，帮某人作弊😂😂😂。</li>
</ul>
<p>后面看看要不要写<code>Mocha</code>吧。</p>
<p>最后，郑重感谢phoenixe同学给了我一个比较系统地学习和使用javascript的机会。谢谢你。</p>
<p>以上。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;从开始写Javascript到现在，已经有一个月了，这一个月学了不少新姿势，随便写写，简单整理一下。&lt;/p&gt;
    
    </summary>
    
      <category term="Javascript" scheme="//blog.stdioa.com/categories/Javascript/"/>
    
    
      <category term="前端开发" scheme="//blog.stdioa.com/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
      <category term="Javascript" scheme="//blog.stdioa.com/tags/Javascript/"/>
    
      <category term="node.js" scheme="//blog.stdioa.com/tags/node-js/"/>
    
  </entry>
  
  <entry>
    <title>博客迁移记（三）</title>
    <link href="//blog.stdioa.com/2016/01/blog-migration-iii/"/>
    <id>//blog.stdioa.com/2016/01/blog-migration-iii/</id>
    <published>2016-01-20T03:40:00.000Z</published>
    <updated>2016-11-08T13:48:35.449Z</updated>
    
    <content type="html"><![CDATA[<p>一个月没更新，期末复习的时候光鼓捣网站却懒得写东西，期末考完了，把这一个月鼓捣的东西记录一下，比如利用七牛进行静态文件托管。</p>
<a id="more"></a>
<h1 id="1">1. 使用七牛托管静态文件</h1>
<h2 id="11">1.1 背景</h2>
<p>博客的事情处理完成后，我又做了一个网站主页，其中包括一个100KB+的背景图片。不过因为我的VPS出站带宽只有1Mb/s, 所以背景图片加载时间过长，导致网站访问速度较慢。所以我将绝大部分的资源全部挂到了七牛上，在服务器端对静态资源请求进行302跳转，将流量转移到七牛的节点，提高访问速度。</p>
<h2 id="12">1.2 操作</h2>
<h3 id="121">1.2.1 同步文件</h3>
<p>我需要托管的文件包括博客和个人主页的所有图片文件。首先，我在七牛上建立了空间<code>cdn-stdioa</code>并绑定了个人域名、申请了HTTPS域名。为方便将本地文件与七牛空间同步，七牛提供了命令行同步工具<code>qrsync</code>. 查看<a href="http://developer.qiniu.com/docs/v6/tools/qrsync.html" target="_blank" rel="external">文档</a>后，我新建并修改了配置文件<code>sync_conf.json</code>，内容如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"src"</span>:          <span class="string">"blog/source/pics"</span>,</div><div class="line">    <span class="attr">"dest"</span>:         <span class="string">"qiniu:access_key=&lt;your_access_key&gt;&amp;secret_key=&lt;your_secret&gt;key&gt;&amp;bucket=cdn-stdioa&amp;key_prefix=blog/pics/"</span>,</div><div class="line">    <span class="attr">"debug_level"</span>:  <span class="number">1</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>若添加资源，则执行<code>qrsync sync_conf.json</code>, 即可完成静态资源与七牛空间的自动同步。</p>
<h3 id="122">1.2.2 在服务器端设置跳转</h3>
<p>为了提高访问速度，需要在nginx端将所有指向图片的请求全部跳转到七牛的链接上。学习了一下location重定向规则，直接上配置文件吧。</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">location</span><span class="regexp"> ^~</span> /pics &#123;</div><div class="line">    <span class="attribute">return</span> https://xxx.qnssl.com/blog<span class="variable">$request_uri</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样，就可以将所有指向<code>/pics</code>的请求全部重定向到七牛的链接。顺便，在七牛设置了一下防盗链。</p>
<h2 id="13-git-hook">1.3 效率提升——Git hook</h2>
<p>因为我的博客和个人主页都是使用Coding+webhook部署的，所以每次更改页面后要推代码，还要同步静态资源。有没有方法可以把这两条操作简化一下呢？一开始写了个批处理脚本，后来觉得一定有更好的办法，于是翻了翻，遇到了<code>Git hook</code>这种神器。
<code>Git hook</code>跟webhook类似，都是在某个操作上挂一个“钩子”，使得在进行某操作发生时自动触发自定义脚本来达到某些目的，实现快捷操作。所有的钩子均在<code>.git/hooks</code>目录下，在该目录下设置特殊文件名的脚本文件来设置钩子。因为我需要在推送代码之前进行资源同步，所以我需要设置<code>pre-push</code>脚本。脚本内容如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line"></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"Sync up the static resources with Qiniu..."</span></div><div class="line"><span class="built_in">cd</span> /f/websites/blog/</div><div class="line">qrsync sync_conf.json 2&gt;&gt;sync.log</div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"Done!"</span></div></pre></td></tr></table></figure>
<p>这样，我就可以在每次执行<code>git push</code>之前自动同步静态资源，少敲一条命令，提升工作效率→_→</p>
<h1 id="2">2. 谱站搭建</h1>
<p>内容不是太多，就写在这里啦。
我有一个乐谱分享站，里面存放一些自己收集的钢琴谱。一年以前写了一个程序，用来为每个文件夹生成index页面。前几天翻开那个程序，一下子被自己写的连环replace吓到了（那个时候连正则还都不会，不过转念一想要是会了正则，写出来的东西会多可怕😂），于是怒用<code>Jinja</code>模板渲染引擎重写了一个，把原来最核心部分的十几行代码变为了一行渲染语句，代码看起来清爽多了。
嗯，具体链接可以在左侧或顶栏的“友情链接”中找。</p>
<h1 id="3">3. 后记</h1>
<p>历经一个月，博客的迁移工作基本完成（刚刚写博客的工夫还给它添加了<code>twemoji</code>支持😶），以后还要做个人页面，不过可能不会有太多可写的地方了。就酱，后面看一阵子go以后可以来写写golang的东西。</p>
<h1 id="4">4. 参考资料</h1>
<p><a href="http://www.seo-guwen.com/post-17.html" target="_blank" rel="external">Nginx重定向规则详细介绍</a>
<a href="http://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90" target="_blank" rel="external">自定义 Git - Git 钩子</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一个月没更新，期末复习的时候光鼓捣网站却懒得写东西，期末考完了，把这一个月鼓捣的东西记录一下，比如利用七牛进行静态文件托管。&lt;/p&gt;
    
    </summary>
    
      <category term="乱七八糟" scheme="//blog.stdioa.com/categories/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F/"/>
    
    
      <category term="nginx" scheme="//blog.stdioa.com/tags/nginx/"/>
    
      <category term="七牛" scheme="//blog.stdioa.com/tags/%E4%B8%83%E7%89%9B/"/>
    
      <category term="git" scheme="//blog.stdioa.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>博客迁移记（二）</title>
    <link href="//blog.stdioa.com/2015/12/blog-migration-ii/"/>
    <id>//blog.stdioa.com/2015/12/blog-migration-ii/</id>
    <published>2015-12-18T07:55:37.000Z</published>
    <updated>2016-11-08T13:48:35.437Z</updated>
    
    <content type="html"><![CDATA[<p>域名依然在备案中，依然想将博客部署到新买的VPS的我和腾讯斗智斗勇（雾），为博客添加了HTTPS&gt;_&lt;
同时，把自己的密码学课设也转移到VPS上来了。</p>
<a id="more"></a>
<h1 id="1-nginxhost">1. 使用Nginx针对多个host部署服务器</h1>
<h2 id="11">1.1 概述</h2>
<p>如果一个VPS只能搭一个网站，那未免太浪费了，所以我们可以通过配置Nginx的方式来将针对多个域名的访问请求分开，从而进行不同的处理。例如，我在DNS配置时将<code>blog.stdioa.com</code>与<code>crypt.stdioa.com</code>同时指向到我的腾讯云的IP地址，用户访问这两个域名时，都会向我的VPS发送请求，我要做的是将这两种针对不同域名的访问请求分开。而这两种请求的区别在HTTP请求头的Host字段，所以我只需要针对不同的Host使用不同的处理方式即可。</p>
<h2 id="12">1.2 操作</h2>
<p>我的VPS上撘有两个网站，其中<code>blog.stdioa.com</code>域名指向的是我的博客——一个静态服务器，而<code>crypt</code>域名指向的是一个使用flask搭建的网站，所以要在Nginx端进行反向代理，将请求转发到本地的5000端口。
具体配置文件如下：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="section">server</span> &#123;</div><div class="line">     <span class="attribute">listen</span>       <span class="number">80</span>;</div><div class="line">     <span class="attribute">server_name</span>  stdioa.com blog.stdioa.com;       <span class="comment"># 通往博客的请求直接通过文件服务器返回</span></div><div class="line"></div><div class="line">     <span class="attribute">access_log</span>  /var/log/nginx/access_blog.log;</div><div class="line">     <span class="attribute">error_log</span> /var/log/nginx/error_blog.log;</div><div class="line"></div><div class="line">     <span class="attribute">root</span>   /home/stdio/blog;</div><div class="line">     <span class="attribute">index</span>  index index.html;</div><div class="line"></div><div class="line">     <span class="attribute">location</span> / &#123;</div><div class="line">     &#125;</div><div class="line">     <span class="attribute">location</span><span class="regexp"> ^~</span> /.git &#123;                            <span class="comment"># 禁止访问.git文件夹</span></div><div class="line">         <span class="attribute">deny</span> all;</div><div class="line">     &#125;</div><div class="line">     <span class="attribute">error_page</span>  <span class="number">404</span>     /<span class="number">404</span>.html;</div><div class="line">&#125;</div><div class="line"><span class="section">server</span> &#123;</div><div class="line">     <span class="attribute">listen</span> <span class="number">80</span>;</div><div class="line">     <span class="attribute">server_name</span> crypt.stdioa.com;                  <span class="comment"># host为crypt的请求转发本地端口</span></div><div class="line"></div><div class="line">     <span class="attribute">access_log</span> /var/log/nginx/access_crypt.log;</div><div class="line">     <span class="attribute">error_log</span> /var/log/nginx/error_crypt.log;</div><div class="line"></div><div class="line">     <span class="attribute">location</span> / &#123;</div><div class="line">         <span class="attribute">proxy_pass</span> http://127.0.0.1:5000/;</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>配置完成后，重启Nginx, 可以看到访问不同域名时，请求会交给不同的程序处理。</p>
<h1 id="2">2. 屏蔽来自特定域名的请求</h1>
<h2 id="21">2.1 背景</h2>
<p>网站部署好后，又发现了一个来自奇怪域名的请求；更坑爹的是，这个域名指向自己的VPS；更更坑爹的是，来自这个域名的请求有好多，直接把我的日志刷爆了…所以我需要将来自这个域名的所有请求拒绝掉。</p>
<h2 id="22">2.2 操作</h2>
<p>新建一个Server就好啦。具体配置文件如下：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="section">server</span> &#123;</div><div class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</div><div class="line">    <span class="attribute">server_name</span> bailigo.com <span class="regexp">*.bailigo.com</span>;</div><div class="line">    <span class="attribute">location</span> / &#123;</div><div class="line">        <span class="attribute">return</span> <span class="number">410</span>;         <span class="comment"># 410 Gone, 使用了这个状态码，不知道能不能不再让爬虫爬这个网页</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>配置完成，重新载入配置文件，成功。
<em>本来想用418, 但是Nginx没有418的返回页面，想了想还是算了吧</em></p>
<h1 id="3-https">3. 为博客部署HTTPS服务器</h1>
<h2 id="31">3.1 背景</h2>
<p><code>blog.stdioa.com</code>博客上午还可以访问，中午吃顿饭就发现访问被截断了，原因与以前一样——域名未完成备案。经查看，腾讯对访问博客的请求进行了301跳转，于是想了想，给博客配置了HTTPS, 让你们再阻断→_→（好吧再阻断的话我真的不知道该怎么弄了</p>
<h2 id="32-lets-encrypt">3.2 使用Let’s Encrypt生成网站证书</h2>
<p>之前就看中了<a href="https://letsencrypt.org/" target="_blank" rel="external">Let’s Encrypt</a>，它提供主流浏览器认证的免费证书，只可惜当时没有域名无法体验。现在有了域名，加上腾讯对未备案的域名查的很紧，所有未备案域名下的网站搭起来半天就被封掉，想了想，还是生成一个证书，配个HTTPS撑一阵子吧╮(╯_╰)╭
按照官方的<a href="https://community.letsencrypt.org/t/quick-start-guide/1631" target="_blank" rel="external">指南</a>以及<a href="http://www.vpser.net/build/letsencrypt-free-ssl.html" target="_blank" rel="external">此指南</a>在将<a href="https://github.com/letsencrypt/letsencrypt" target="_blank" rel="external">Let’s Encrypt的Repo</a> clone到本地之后，输入<code>./letsencrypt-auto certonly --email 邮箱 -d 域名 --agree-tos</code>来生成证书。由于腾讯云到Let’s Encrypt的服务器的链接极其不稳定，通常需要重试很多次才能正常跟Let’s Encrypt的服务器通信。成功后会显示：</p>
<blockquote>
<p>IMPORTANT NOTES:
- Congratulations! Your certificate and chain have been saved at
/etc/letsencrypt/live/blog.stdioa.com/fullchain.pem. Your cert
will expire on 2016-03-17. To obtain a new version of the
certificate in the future, simply run Let’s Encrypt again.
- If you like Let’s Encrypt, please consider supporting our work by:</p>
<p>Donating to ISRG / Let’s Encrypt:   <a href="https://letsencrypt.org/donate" target="_blank" rel="external">https://letsencrypt.org/donate</a>
Donating to EFF:                    <a href="https://eff.org/donate-le" target="_blank" rel="external">https://eff.org/donate-le</a></p>
</blockquote>
<p>证书已存储在上面信息指示的目录。</p>
<h2 id="33-nginx-https">3.3 配置Nginx, 搭建HTTPS服务器</h2>
<p>证书已生成，下面该配置Nginx了，添加下列配置：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="section">server</span> &#123;</div><div class="line">    <span class="attribute">listen</span>  <span class="number">443</span> ssl;</div><div class="line">    <span class="attribute">server_name</span>  blog.stdioa.com;</div><div class="line"></div><div class="line">    <span class="attribute">ssl_certificate</span> /etc/letsencrypt/live/blog.stdioa.com/fullchain.pem;        <span class="comment"># 添加证书</span></div><div class="line">    <span class="attribute">ssl_certificate_key</span> /etc/letsencrypt/live/blog.stdioa.com/privkey.pem;      <span class="comment"># 添加密钥</span></div><div class="line">    <span class="attribute">ssl_ciphers</span> <span class="string">"EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH"</span>;</div><div class="line">    <span class="attribute">ssl_protocols</span> TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</div><div class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</div><div class="line">    <span class="attribute">ssl_session_cache</span> shared:SSL:<span class="number">10m</span>;</div><div class="line"></div><div class="line">    <span class="comment"># 后面和普通服务器一样</span></div><div class="line">    <span class="attribute">access_log</span>  /var/log/nginx/access_blog.log;</div><div class="line">    <span class="attribute">error_log</span> /var/log/nginx/error_blog.log;</div><div class="line"></div><div class="line">    <span class="attribute">root</span>   /home/stdio/blog;</div><div class="line">    <span class="attribute">index</span>  index index.html;</div><div class="line"></div><div class="line">    <span class="attribute">location</span><span class="regexp"> ^~</span> /.git &#123;</div><div class="line">        <span class="attribute">deny</span> all;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="attribute">error_page</span>  <span class="number">404</span> /<span class="number">404</span>.html;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>重新加载配置，访问<a href="https://blog.stdioa.com" target="_blank" rel="external">https://blog.stdioa.com</a> , 成功~</p>
<p>小插曲：
昨天晚上熄灯之前发现Ubuntu上使用<code>apt-get</code>安装的Nginx版本太老了，于是在VPS上重新编译升级了Nginx，结果配置好HTTPS以后重启Nginx时发现启动失败，原因为缺少<code>ngx</code>组件。经Google后发现没有编译该组件，所以重新编译安装Nginx, 在配置时加入<code>--with-http_ssl_module</code>选项。</p>
<p>小插曲2：
HTTPS配置好后访问博客，Chrome提示“存在不安全的内容”，选择加载后，地址栏左边的HTTPS会变成红色，极其不好看（雾），于是看了博客的模板，发现有两个js在加载时选择使用HTTP方式加载，于是将<code>http://.../*.js</code>改为<code>//.../*.js</code>, 使浏览器可以根据当前协议自动选择JS文件的加载协议。更新博客模板，重新访问，所有js均使用HTTPS方式加载，问题解决。附图:</p>
<center>![哈哈哈HTTPS](/pics/hhh_HTTPS.jpg)</center>
<p>小插曲3：
上面那张图片的链接之前来自七牛，采用HTTP协议而不是HTTPS加载。发布这篇博文后，我发现该文章页面中地址栏左侧的HTTPS标志变为了白色…还是不好看！打开Chrome的控制台，在控制台中看到，如果图片链接协议为HTTPS，则Chrome依然会提示“不安全”，但是个人感觉这只是一张图片而已啊，又不是JS_(:зゝ∠)_
解决方案：将图片链接改回本地，待域名备案后再想办法在七牛那边解决域名绑定及HTTPS的问题。</p>
<h1 id="4">4. 参考资料</h1>
<p><a href="http://www.vpser.net/build/letsencrypt-free-ssl.html" target="_blank" rel="external">免费SSL安全证书Let’s Encrypt安装使用教程(附Nginx/Apache配置)</a>
<a href="http://blog.csdn.net/donghustone/article/details/25797727" target="_blank" rel="external">http://blog.csdn.net/donghustone/article/details/25797727</a>
<a href="http://serverfault.com/questions/438889/nginx-ssl-error" target="_blank" rel="external">nginx SSL error - Server Fault</a>
<a href="http://www.zzidc.com/main/help/showHelpContent/id_473.html" target="_blank" rel="external">网站存在不安全因素的解决办法</a></p>
<h1 id="5">5. 后记</h1>
<p>快递已发出，相片已审核成功，腾讯收到资料之后会尽快报管局审理…希望2016年之前能够备案成功QvQ
嗯，Google真好用
<strong>说好的准备考试呢！</strong></p>
<hr>
<p><strong>Update @ 16:38</strong>
上午才把资料用快递发走，下午腾讯云就说我的纸质资料已收到…打电话问了一下，客服说腾讯为了加快审核速度，帮我准备了一份材料上交管局，估计他们是用我的扫描件打印了一份交上去了吧，也是不错2333 最后希望通信交通管理局快一点_(:зゝ∠)_</p>
<hr>
<p><strong>Update @ 19:59, Dec. 24th, 2015</strong>
腾讯云访问Github的速度太慢了，于是将博客的Repo迁移到了Coding上。</p>
<ol>
<li>建立私有项目</li>
<li>设置部署公钥
因为是私有项目所以无法通过一个__不含用户名密码__的链接访问Repo来进行Pull，所以还是通过SSH访问比较舒服一些。</li>
<li>改掉VPS上的origin链接，完成</li>
</ol>
<p>曾经听到过一种说法：用HTTPS访问Git Repo要比SSH更好，然而一直不知道好在哪…记得用HTTPS访问Repo的时候账户的用户名和密码是要附在链接里面的，感觉好不安全
域名备案看来真的要奔着20天的样子去了…</p>
<p><strong>Update @ 11:07, Jan. 5th, 2015</strong>
域名备案在2016年的第一个工作日通过啦！庆祝一下，期末之后开始准备制作个人网站~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;域名依然在备案中，依然想将博客部署到新买的VPS的我和腾讯斗智斗勇（雾），为博客添加了HTTPS&amp;gt;_&amp;lt;
同时，把自己的密码学课设也转移到VPS上来了。&lt;/p&gt;
    
    </summary>
    
      <category term="乱七八糟" scheme="//blog.stdioa.com/categories/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F/"/>
    
    
      <category term="nginx" scheme="//blog.stdioa.com/tags/nginx/"/>
    
      <category term="Github" scheme="//blog.stdioa.com/tags/Github/"/>
    
      <category term="Let&#39;s Encrypt" scheme="//blog.stdioa.com/tags/Let-s-Encrypt/"/>
    
  </entry>
  
  <entry>
    <title>博客迁移记（一）</title>
    <link href="//blog.stdioa.com/2015/12/blog-migration/"/>
    <id>//blog.stdioa.com/2015/12/blog-migration/</id>
    <published>2015-12-17T11:55:37.000Z</published>
    <updated>2016-11-08T13:48:35.455Z</updated>
    
    <content type="html"><![CDATA[<p>昨天买了一个VPS、一个域名，决定把博客迁移到VPS上。</p>
<a id="more"></a>
<h1 id="1">1. 背景介绍</h1>
<p>首先打个广告：借助“腾讯云+校园”计划，我成功地用上了1元/月的服务器和11元/月的.com域名。
有了国内访问速度极快的VPS，有了域名，就想自己鼓捣鼓捣，把自己的博客和其他站点托管到VPS上。</p>
<h1 id="2">2. 博客托管</h1>
<h2 id="21">2.1 搭建静态文件服务器</h2>
<p>因为自己的博客是静态博客，之前托管在<a href="https://github.com/StdioA/stdioa.github.io" target="_blank" rel="external">Github</a>上，依靠Github Pages实现部署，所以我先将文件clone了下来，存放在<code>~/blog</code>目录中。
下面要做的，是搭建一个静态服务器。</p>
<h3 id="211-pythonsimplehttpserver">2.1.1 使用Python的SimpleHTTPServer</h3>
<p>Python的SimpleHTTPServer是一个非常实用、方便的库，可以使用简单一条命令在当前目录创建一个HTTP文件服务器。所以输入<code>sudo python -m SimpleHTTPServer 80</code>命令，即可搭建一个静态文件服务器，实现从外网对静态博客的直接访问。
然而搭建好后，我发现了一个问题：因为我的blog文件夹本身是一个Git Repo, 所以我可以直接从外网访问.git文件夹，虽然我的.git目录没有保存任何设置及账户等，但这样会带来一定的安全隐患，所以要想办法禁止外部用户对.git文件夹的访问。</p>
<h3 id="212-nginx">2.1.2 使用Nginx托管文件服务器</h3>
<p>关于Nginx的介绍，请自行访问<a href="http://nginx.org/" target="_blank" rel="external">官网</a>与<a href="https://en.wikipedia.org/wiki/Nginx" target="_blank" rel="external">维基百科</a>。
之前用过Apache, 但是在接触Nginx后，我认为我对Nginx更有好感，所以采用了Nginx做为文件托管服务器。
首先安装Nginx，删掉<code>/etc/nginx/sites-enabled</code>目录（我的系统是Ubuntu Server 14.04 LTS），在<code>conf.d</code>目录中设置配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;                              # 监听端口</div><div class="line">    server_name server;</div><div class="line">    root /home/ubuntu/blog;                 # 托管目录</div><div class="line">    index index.html;</div><div class="line">    access_log /var/log/nginx/access_blog.log</div><div class="line">    error_log /var/log/nginx/error_blog.log</div><div class="line"></div><div class="line">    # 禁止对.git目录的访问</div><div class="line">    location ^~ /.git &#123;</div><div class="line">        deny all;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>配置完成后，重启Nginx, 所有服务正常运行，访问.git目录时会返回403.</p>
<p><em>SimpleHTTPServer在建立服务器的时候只能监听<code>0.0.0.0</code>而不能只监听<code>127.0.0.1</code>, 之前搭建服务器的时候用的SimpleHTTPServer+Nginx反向代理，现在看起来感觉我就是个傻逼…</em></p>
<h2 id="22-webhook">2.2 借助Webhook实现博客的自动部署</h2>
<p>因为之前静态博客托管在Github Pages上，所以向Github Repo上面进行push操作之后会动态更新页面。但是如果将静态博客托管在VPS上，则需要每次执行<code>git pull</code>才能够将内容更新。所以我在VPS上写了一个脚本，能够在Push之后自动进行<code>git pull</code>来更新内容。</p>
<ol>
<li>
<p>在Github上的repo设置Webhook
在repo的设置页面可以设置Webhook, 可在该repo收到push之后，Github可以向一个特定的URL发送一个POST请求。所以我设置了一个Webhook, 在push之后可以向我的VPS的特定端口发送POST请求。</p>
</li>
<li>
<p>设置服务器接收Webhook
在VPS中配置一个服务器，开放VPS的一个端口来接收来自Github的Webhook，这里使用bottle来搭建服务器框架。服务器代码:</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># coding: utf-8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> *</div><div class="line"></div><div class="line"><span class="meta">@route("/push", method=["POST"])    # 监听Webhook</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pull</span><span class="params">()</span>:</span></div><div class="line">    os.system(<span class="string">"./auto_pull.sh"</span>)     <span class="comment"># 执行git pull脚本</span></div><div class="line">    <span class="keyword">return</span> <span class="string">"OK"</span></div><div class="line"></div><div class="line">run(host=<span class="string">"0.0.0.0"</span>, port=<span class="number">23333</span>)</div></pre></td></tr></table></figure>
<ol start="3">
<li>编写自动pull脚本
编写自动pull脚本<code>auto_pull.sh</code>:</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env sh</div><div class="line"></div><div class="line">cd ~/blog</div><div class="line">git pull</div></pre></td></tr></table></figure>
<p>运行服务器，则可监听23333端口的POST请求，然后自动执行<code>git pull</code>更新博客内容。</p>
<h1 id="3">3. 后记</h1>
<p>至此，博客<strong>部分</strong>成功迁移到VPS.
为什么要说“部分”？因为我的域名在做备案啊QvQ备案好麻烦还要打印材料还要跑到市中心去照相还要发快递到北京QvQ都做好还得等待管局审核QvQ
吐槽时间结束。后面等域名备案好以后可能会鼓捣一阵子Nginx，为服务器启用HTTPS等…
<strong>唉，还是先去复习吧_(:зゝ∠)_</strong></p>
<p>_在写博文时，去编译升级了一下Nginx, 鼓捣配置文件又弄了半天_╮(╯_╰)╭</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;昨天买了一个VPS、一个域名，决定把博客迁移到VPS上。&lt;/p&gt;
    
    </summary>
    
      <category term="乱七八糟" scheme="//blog.stdioa.com/categories/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F/"/>
    
    
      <category term="nginx" scheme="//blog.stdioa.com/tags/nginx/"/>
    
      <category term="Github" scheme="//blog.stdioa.com/tags/Github/"/>
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>随手记 - 解决InsecurePlatformWarning</title>
    <link href="//blog.stdioa.com/2015/12/essay-solve-InsecurePlatformWarning/"/>
    <id>//blog.stdioa.com/2015/12/essay-solve-InsecurePlatformWarning/</id>
    <published>2015-12-07T15:01:00.000Z</published>
    <updated>2016-11-08T13:48:35.493Z</updated>
    
    <content type="html"><![CDATA[<p>第三次在VPS上面解决使用requests报InsecurePlatformWarning警告的问题。之前每次都要查资料折腾好久，这次决定把它记下来。</p>
<a id="more"></a>
<h1 id="1">1. 干货</h1>
<ul>
<li>
<p>Debian类系统</p>
<ol>
<li><code>sudo apt-get install python-dev libssl-dev</code></li>
<li><code>sudo pip install -U requests[security]</code></li>
</ol>
</li>
<li>
<p>Redhat类系统</p>
<ol>
<li><code>sudo yum install python-devel openssl-devel</code></li>
<li><code>sudo pip install -U requests[security]</code></li>
</ol>
</li>
</ul>
<h1 id="2">2. 需求</h1>
<p>自己的VPS系统有点老(Ubuntu 14.04 LTS), 所以python版本也比较落后(Python 2.7.3), 今天改代码需要用到requests新版本中提供的功能，但是requests升级后发送HTTPS请求时会报出InsecurePlatformWarning, 这是一个由openssl漏洞(Heartbleed)造成的警告，所以需要升级pyopenssl等模块。</p>
<h1 id="3">3. 升级过程</h1>
<p>pypi提供了一个升级包，叫做<code>requests[security]</code>, 用pip进行升级即可。输入<code>sudo pip install requests[security]</code>命令后，pip报错，才发现不能本地编译python包，遂安装<code>python-dev</code>. 然后再次安装时发现缺少<code>openssl/aes.h</code>头文件，又去安装openssl的开发包<code>libssl-dev</code>, 再次安装，安装成功。</p>
<h1 id="4">4. 参考资料</h1>
<ol>
<li><a href="http://blog.csdn.net/blog/henulwj/48131393" target="_blank" rel="external">[原]pip安装模块警告InsecurePlatformWarning</a></li>
<li><a href="http://stackoverflow.com/questions/30539798/zsh-no-matches-found-requestssecurity" target="_blank" rel="external">zsh - no matches found: requests[security]</a></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;第三次在VPS上面解决使用requests报InsecurePlatformWarning警告的问题。之前每次都要查资料折腾好久，这次决定把它记下来。&lt;/p&gt;
    
    </summary>
    
      <category term="随手记" scheme="//blog.stdioa.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
      <category term="openssl" scheme="//blog.stdioa.com/tags/openssl/"/>
    
      <category term="requests" scheme="//blog.stdioa.com/tags/requests/"/>
    
  </entry>
  
  <entry>
    <title>Python学习之unittest</title>
    <link href="//blog.stdioa.com/2015/11/learning-python-unittest/"/>
    <id>//blog.stdioa.com/2015/11/learning-python-unittest/</id>
    <published>2015-11-12T10:53:02.000Z</published>
    <updated>2016-11-08T13:48:35.538Z</updated>
    
    <content type="html"><![CDATA[<p>单元测试，工程开发中重要的一环。</p>
<a id="more"></a>
<h1 id="1">1. 简介</h1>
<p>单元测试是用来对一个模块、一个函数或者一个类来进行正确性检验的测试工作。</p>
<h1 id="2-unittest">2. 使用unittest进行测试</h1>
<p>unittest是Python自带的单元测试模块，通过编写测试类，在测试类中编写测试函数的方式进行测试。
不知道该测试什么，就对python的list对象测试一下好了。</p>
<h2 id="21">2.1 编写测试文件</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf-8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> unittest                                 <span class="comment"># 使用unittest模块</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestStringMethods</span><span class="params">(unittest.TestCase)</span>:</span>     <span class="comment"># 测试类需继承自unittest.TestCase</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment"># 在函数里进行测试之前需要进行的一些准备工作，setUp在每次测试之前都会运行一次</span></div><div class="line">        self.d = []</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_empty</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""\</span></div><div class="line">        Empty testcase</div><div class="line">        """</div><div class="line">        self.assertEqual([], [])                <span class="comment"># 若a和b相等则通过</span></div><div class="line">        self.assertNotEqual([<span class="number">1</span>], [])            <span class="comment"># 若不相等则通过</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_bool</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""\</span></div><div class="line">        Bool transform testcase</div><div class="line">        """</div><div class="line">        self.assertTrue([<span class="number">1</span>])                    <span class="comment"># 若内部的表达式或对象为真则通过</span></div><div class="line">        self.assertFalse([])                    <span class="comment"># 为假则通过</span></div><div class="line">        self.assertTrue(bool([<span class="number">1</span>]))</div><div class="line">        self.assertFalse(bool([]))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_append</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""\</span></div><div class="line">        Append testcase</div><div class="line">        """</div><div class="line">        list_ = []</div><div class="line">        list_.append(<span class="number">1</span>)</div><div class="line">        self.assertEqual(list_, [<span class="number">1</span>])</div><div class="line">        self.assertNotEqual(list_, [])</div><div class="line">        list_.append(<span class="number">2</span>)</div><div class="line">        self.assertIn(<span class="number">1</span>, list_)                 <span class="comment"># 若a in b则通过</span></div><div class="line">        self.assertNotIn(<span class="number">3</span>, list_)              <span class="comment"># 若a not in b则通过</span></div><div class="line">        self.assertTrue(list_[<span class="number">0</span>] == <span class="number">1</span>)</div><div class="line">        self.assertEqual(list_[<span class="number">1</span>], <span class="number">2</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_instance</span><span class="params">(self)</span>:</span></div><div class="line">        list_ = []</div><div class="line">        self.assertIsInstance(list_, list)      <span class="comment"># 若isinstance(a, b)为真则通过</span></div><div class="line">        self.assertNotIsInstance(list_, str)    <span class="comment"># 若isinstance(a, b)为假则通过</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_index</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""\</span></div><div class="line">        Index testcase</div><div class="line">        """</div><div class="line">        list_ = []</div><div class="line">        <span class="keyword">with</span> self.assertRaises(IndexError):     <span class="comment"># 检测是否有异常抛出，有指定异常抛出则通过</span></div><div class="line">            a = list_[<span class="number">0</span>]</div><div class="line"></div><div class="line">        list_ = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line">        self.assertEqual(list_[<span class="number">1</span>], <span class="number">2</span>)</div><div class="line">        self.assertEqual(list_[<span class="number">-2</span>], <span class="number">2</span>)</div><div class="line"></div><div class="line">        <span class="keyword">with</span> self.assertRaises(IndexError):</div><div class="line">            a = list_[<span class="number">4</span>]</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment"># 在测试之后需要进行的一些处理事项，tearDown在每次测试之后都会运行一次</span></div><div class="line">        <span class="keyword">del</span> self.d</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    __import__(<span class="string">"sys"</span>).argv.append(<span class="string">"-v"</span>)         <span class="comment"># 采用verbose方式，输出测试信息</span></div><div class="line">    unittest.main()</div></pre></td></tr></table></figure>
<h2 id="22">2.2 运行测试</h2>
<ul>
<li>直接运行测试程序，输出:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">test_append (__main__.TestStringMethods)</div><div class="line">Append testcase ... ok</div><div class="line">test_bool (__main__.TestStringMethods)</div><div class="line">Bool transform testcase ... ok</div><div class="line">test_empty (__main__.TestStringMethods)</div><div class="line">Empty testcase ... ok</div><div class="line">test_index (__main__.TestStringMethods)</div><div class="line">Index testcase ... ok</div><div class="line">test_instance (__main__.TestStringMethods) ... ok</div><div class="line"></div><div class="line">----------------------------------------------------------------------</div><div class="line">Ran 5 tests <span class="keyword">in</span> 0.001s</div><div class="line"></div><div class="line">OK</div></pre></td></tr></table></figure>
<ul>
<li>运行<code>python -m unittest test.py</code>也可以进行测试；</li>
<li>运行<code>python -m unittest</code>, unittest会在当前文件夹中寻找测试类进行测试（真智能）；</li>
<li>若有测试未通过，unittest会在测试时报告FAIL, 并在测试结束后将所有未通过测试的项目列出。</li>
</ul>
<h1 id="3-nose">3. 使用Nose进行单元测试</h1>
<p>Nose是一个对unittest的扩展测试框架，能自动发现并运行测试。使用Nose，可以将单元测试代码的编写变得更简单，不用再构造测试类，只需要在以<code>test</code>开头的文件中建立以<code>test</code>开头的函数即可。</p>
<h2 id="31">3.1 编写测试文件</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf-8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> nose</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_nose_installed_successfully</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">import</span> nose                         <span class="comment"># 运行测试代码</span></div><div class="line">    <span class="keyword">assert</span> <span class="keyword">True</span>                         <span class="comment"># assert True表示测试成功</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_obviously_failed</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">assert</span> <span class="keyword">False</span>                        <span class="comment"># assert False表示测试失败，测试时会报"FAIL"</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_returns_an_exception</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">raise</span> ValueError                    <span class="comment"># 若抛出除AssertionError的异常，测试时会报"ERROR"</span></div><div class="line"></div><div class="line">nose.main()</div></pre></td></tr></table></figure>
<h2 id="32">3.2 运行测试文件</h2>
<p>nose自带可执行文件，所以只需要输入<code>nosetests [测试文件名]</code>即可，若测试文件名为空，则nosetest会在当前文件夹寻找所有测试。以下命令格式均可接受：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">nosetests test.module</div><div class="line">nosetests another.test:TestCase.test_method</div><div class="line">nosetests a.test:TestCase</div><div class="line">nosetests /path/to/<span class="built_in">test</span>/file.py:test_function</div></pre></td></tr></table></figure>
<p>运行<code>nosetests test_with_nose -v</code>，输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">$ nosetests test_with_nose -v</div><div class="line">test_with_nose.test_nose_installed_successfully ... ok</div><div class="line">test_with_nose.test_obviously_failed ... FAIL</div><div class="line">test_with_nose.test_returns_an_exception ... ERROR</div><div class="line"></div><div class="line">======================================================================</div><div class="line">ERROR: test_with_nose.test_returns_an_exception</div><div class="line">----------------------------------------------------------------------</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"c:\python35\lib\site-packages\nose\case.py"</span>, line 198, <span class="keyword">in</span> runTest</div><div class="line">    self.test(*self.arg)</div><div class="line">  File <span class="string">"C:\Users\Stdio\Desktop\temp\utest\test_with_nose.py"</span>, line 13, <span class="keyword">in</span> test_returns_an_exception</div><div class="line">    raise ValueError</div><div class="line">ValueError</div><div class="line"></div><div class="line">======================================================================</div><div class="line">FAIL: test_with_nose.test_obviously_failed</div><div class="line">----------------------------------------------------------------------</div><div class="line">Traceback (most recent call last):</div><div class="line"> File <span class="string">"c:\python35\lib\site-packages\nose\case.py"</span>, line 198, <span class="keyword">in</span> runTest</div><div class="line">   self.test(*self.arg)</div><div class="line">  File <span class="string">"C:\Users\Stdio\Desktop\temp\utest\test_with_nose.py"</span>, line 10, <span class="keyword">in</span> test_obviously_failed</div><div class="line">   assert False</div><div class="line">AssertionError</div><div class="line"></div><div class="line">----------------------------------------------------------------------</div><div class="line">Ran 3 tests <span class="keyword">in</span> 0.003s</div><div class="line"></div><div class="line">FAILED (errors=1, failures=1)</div></pre></td></tr></table></figure>
<h1 id="4">4. 参考文档</h1>
<ol>
<li><a href="https://docs.python.org/3/library/unittest.html" target="_blank" rel="external">unitest - Python Doc</a></li>
<li><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143191629979802b566644aa84656b50cd484ec4a7838000" target="_blank" rel="external">单元测试 - 廖雪峰的python教程</a></li>
<li><a href="https://nose.readthedocs.org/en/latest/" target="_blank" rel="external">Nose documentation</a></li>
<li><a href="http://blog.csdn.net/linda1000/article/details/8533349" target="_blank" rel="external">Python的学习（十八）---- 单元测试工具nose</a></li>
</ol>
<h1 id="5">5. 后记</h1>
<p>拖了一个月，这个坑再不填日子没法过了(╯‵□′)╯︵┻━┻
到现在没给自己的代码写过测试，也是醉…
一直想转Py3一直没转，昨天改了环境变量，强迫自己用一阵子，多去看看Py3的特性，有时间整理一下。
Git的坑还没填完不过自己的Pro Git看的差不多了，貌似也满足自己的需求了，准备弃坑。
下一篇有可能是SQLAlchemy, MongoDB, Flask…哎，随它去吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;单元测试，工程开发中重要的一环。&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="//blog.stdioa.com/categories/Python/"/>
    
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
      <category term="unittest" scheme="//blog.stdioa.com/tags/unittest/"/>
    
  </entry>
  
  <entry>
    <title>Python学习之collections</title>
    <link href="//blog.stdioa.com/2015/10/learning-python-collections/"/>
    <id>//blog.stdioa.com/2015/10/learning-python-collections/</id>
    <published>2015-10-29T12:55:00.000Z</published>
    <updated>2016-11-08T13:48:35.517Z</updated>
    
    <content type="html"><![CDATA[<p>collection是Python内建的一个实用工具包，提供一些使用的容器，用于对传统容器类型进行功能提升。</p>
<a id="more"></a>
<h1 id="1">1. 简介</h1>
<p>上面就是简介，不会扯了，贴两个链接好了。
<a href="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/001411031239400f7181f65f33a4623bc42276a605debf6000" target="_blank" rel="external">Collections - 廖雪峰的Python教程</a>
<a href="https://docs.python.org/2.7/library/collections.html#module-collections" target="_blank" rel="external">Collections - High-performance container datatypes - Python Doc</a></p>
<h1 id="2-namedtuple">2. namedtuple</h1>
<h2 id="21">2.1 功能简介</h2>
<p><code>namedtuple</code>为一个函数，用于产生一个tuple类的子类。由该类实例化后的对象可以像tuple一样pack/unpack，也可以通过预先定义好的成员名称访问对象内部的数据。例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from collections import namedtuple</div><div class="line">&gt;&gt;&gt; Point = namedtuple(<span class="string">"Point"</span>, [<span class="string">'x'</span>, <span class="string">'y'</span>])</div><div class="line">&gt;&gt;&gt; Point                                           <span class="comment"># namedtuple函数返回一个类</span></div><div class="line">&lt;class <span class="string">'__main__.Point'</span>&gt;</div><div class="line">&gt;&gt;&gt; Point.__base__</div><div class="line">&lt;<span class="built_in">type</span> <span class="string">'tuple'</span>&gt;</div><div class="line">&gt;&gt;&gt; Point(x=1, y=2)</div><div class="line">Point(x=1, y=2)</div><div class="line">&gt;&gt;&gt; Point(1,2)                                      <span class="comment"># 两种定义方式均可，但是要注意的是，Point的参数长度是不可变的</span></div><div class="line">Point(x=1, y=2)</div><div class="line">&gt;&gt;&gt; p = Point(1, 2)</div><div class="line">&gt;&gt;&gt; p.x</div><div class="line">1</div><div class="line">&gt;&gt;&gt; x, y = p                                        <span class="comment"># 可以像tuple一样进行unpack</span></div><div class="line">&gt;&gt;&gt; x</div><div class="line">1</div><div class="line">&gt;&gt;&gt; Point._make((1,2))                              <span class="comment"># pack的方式和tuple不同</span></div><div class="line">Point(x=1, y=2)</div></pre></td></tr></table></figure>
<h2 id="22">2.2 成员函数</h2>
<ul>
<li><code>somenamedtuple._make(iterable)</code>, 将一个可迭代对象（list, tuple等）转化为一个namedtuple对象。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = [<span class="number">11</span>, <span class="number">22</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Point._make(t)</div><div class="line">Point(x=<span class="number">11</span>, y=<span class="number">22</span>)</div></pre></td></tr></table></figure>
<ul>
<li><code>somenamedtuple._asdict()</code>, 将对象转化一个为键值和数据对应的OrderedDict.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>p._asdict()</div><div class="line">OrderedDict([(<span class="string">'x'</span>, <span class="number">11</span>), (<span class="string">'y'</span>, <span class="number">22</span>)])</div></pre></td></tr></table></figure>
<ul>
<li><code>somenamedtuple._replace(kwargs)</code>, 返回一个新对象，该对象中的值按照_replace函数中的参数所改变。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = Point(x=<span class="number">11</span>, y=<span class="number">22</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p._replace(x=<span class="number">33</span>)</div><div class="line">Point(x=<span class="number">33</span>, y=<span class="number">22</span>)</div></pre></td></tr></table></figure>
<ul>
<li><code>somenamedtuple._fields</code>, 返回一个所有键值构成的dict.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>p._fields                                                       <span class="comment"># 查看键值名字</span></div><div class="line">(<span class="string">'x'</span>, <span class="string">'y'</span>)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Color = namedtuple(<span class="string">'Color'</span>, <span class="string">'red green blue'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Pixel = namedtuple(<span class="string">'Pixel'</span>, Point._fields + Color._fields)      <span class="comment"># 将Color和Point“合并”</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Pixel(<span class="number">11</span>, <span class="number">22</span>, <span class="number">128</span>, <span class="number">255</span>, <span class="number">0</span>)</div><div class="line">Pixel(x=<span class="number">11</span>, y=<span class="number">22</span>, red=<span class="number">128</span>, green=<span class="number">255</span>, blue=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<h2 id="23">2.3 应用场景</h2>
<p>列举一个应用场景：在进行sql查询时，<code>cur.fetchone()</code>会返回一个tuple而不是dict，我们可以定义一个namedtuple, 然后将sql的查询数据转为namedtuple类，然后通过成员函数访问。举个栗子（私货）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Account = namedtuple(<span class="string">"Account"</span>, [<span class="string">"username"</span>, <span class="string">"password"</span>])   <span class="comment"># 定义Account类</span></div><div class="line">...</div><div class="line">cur = self.db.cursor()</div><div class="line">cur.execute(<span class="string">"SELECT username, password FROM account\</span></div><div class="line">                WHERE valid=1\</div><div class="line">                ORDER BY RANDOM()\</div><div class="line">                LIMIT 1")</div><div class="line">account= Account._make(cur.fetchone())                      <span class="comment"># 将数据tuple转为Account对象</span></div><div class="line">self.postdata[<span class="string">"username"</span>] = account.username                <span class="comment"># 直接访问成员数据</span></div><div class="line">self.postdata[<span class="string">"password"</span>] = account.password</div><div class="line">...</div><div class="line"><span class="comment"># self.login(username, password)</span></div><div class="line">self.login(account)                                         <span class="comment"># 可以将account整体作为参数，使程序看起来更简洁</span></div><div class="line">...</div></pre></td></tr></table></figure>
<h1 id="3-deque-">3. deque - 双端队列</h1>
<h2 id="31">3.1 介绍</h2>
<p>deque为Double-Ended Queue的简写，用于提供一个可以快速进行两端的插入或删除操作的队列，同时可以像list一样通过下标访问数据。由于list是储存在线性空间的，其插入/删除数据的时间复杂度为O(n)，所以当list比较长的时候，在其头部插入/删除数据的操作需要耗费大量时间。所以如果需要对list对象进行大量头和尾的插入删除操作时，使用deque会使程序的运行效率更高（当然，使用Queue模块的Queue和LifoQueue也是不错的选择）。需要注意的是，deque对象不支持在中间位置的插入操作。
deque对象也被包含在Queue模块中。</p>
<h2 id="32">3.2 成员函数</h2>
<ul>
<li><code>append(x)</code>, <code>appendleft(x)</code>, 在deque的尾/头插入对象x, 与list类似；</li>
<li><code>extend(iterable)</code>, <code>extendleft(iterable)</code>, 与list的extend类似；</li>
<li><code>pop(x)</code>, <code>popleft(x)</code>, 与list的pop类似；</li>
<li><code>clear()</code>, 清空deque的所有元素；</li>
<li><code>count(x)</code>, 统计deque中x元素的个数；</li>
<li><code>remove(x)</code>, 删除deque中的x元素，若x元素不存在，则触发ValueError;</li>
<li><code>reverse()</code>, 将deque反转，返回None, 与list的reverse类似;</li>
<li><code>rotate(i)</code>, 将deque最末尾i个元素取出并插入头部，若i&lt;0, 则将头部|i|个元素取出添加到尾部。</li>
</ul>
<h1 id="4-counter-">4. Counter - 计数器</h1>
<h2 id="41">4.1 介绍</h2>
<p>Counter类是dict的子类，提供一个计数器，可对hashable的对象进行计数。需要注意的是，对象的计数可以小于0.</p>
<h2 id="42">4.2 基本操作</h2>
<p>直接上例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter()                           <span class="comment"># 空计数器</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter(<span class="string">'gallahad'</span>)                 <span class="comment"># 对iterable对象中的元素进行计数</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter(&#123;<span class="string">'red'</span>: <span class="number">4</span>, <span class="string">'blue'</span>: <span class="number">2</span>&#125;)      <span class="comment"># 从map中读取元素和对应计数</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter(cats=<span class="number">4</span>, dogs=<span class="number">8</span>)             <span class="comment"># 从关键字参数中获取</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'dogs'</span>: <span class="number">8</span>, <span class="string">'cats'</span>: <span class="number">4</span>&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c[<span class="string">"dogs"</span>]                               <span class="comment"># 获取计数</span></div><div class="line"><span class="number">8</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c[<span class="string">"elephants"</span>]                          <span class="comment"># 对于不存在的元素，会返回0 </span></div><div class="line"><span class="number">0</span></div></pre></td></tr></table></figure>
<h2 id="43">4.3 成员函数</h2>
<ul>
<li><code>elements()</code>, 返回一个迭代器，包含Counter中的所有元素，若元素x的计数为n，则x在迭代器中会出现n次。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">c = Counter(a=<span class="number">4</span>, b=<span class="number">2</span>, c=<span class="number">0</span>, d=<span class="number">-2</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(c.elements())</div><div class="line">[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>]</div></pre></td></tr></table></figure>
<ul>
<li><code>most_common([n])</code>, 返回计数最多的n个元素。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>Counter(<span class="string">'abracadabra'</span>).most_common(<span class="number">3</span>)</div><div class="line">[(<span class="string">'a'</span>, <span class="number">5</span>), (<span class="string">'r'</span>, <span class="number">2</span>), (<span class="string">'b'</span>, <span class="number">2</span>)]</div></pre></td></tr></table></figure>
<ul>
<li><code>update([iterable-or-mapping])</code>, 在现有计数上添加参数所对应的计数。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter(<span class="string">"1233"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'3'</span>: <span class="number">2</span>, <span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">1</span>&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c.update(<span class="string">"2345"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'3'</span>: <span class="number">3</span>, <span class="string">'2'</span>: <span class="number">2</span>, <span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'5'</span>: <span class="number">1</span>, <span class="string">'4'</span>: <span class="number">1</span>&#125;)</div></pre></td></tr></table></figure>
<ul>
<li><code>substact([iterable-or-mapping])</code>, 在现有计数上减去参数所对应的计数。</li>
</ul>
<p>可以用在Counter对象上的通用函数和常见用法有：</p>
<ul>
<li><code>sum(c.values())</code>, 所有计数之和</li>
<li><code>c.clear()</code>, 将计数重置</li>
<li><code>list(c)</code>, 返回所有元素构成的列表, 其中元素不会重复</li>
<li><code>set(c)</code>, 转化为set</li>
<li><code>dict(c)</code>, 转化为dict</li>
<li><code>c.items()</code>, 转化为由(元素, 计数)构成的列表</li>
<li><code>Counter(dict(list_of_pairs))</code>, 从上述列表转化为Counter对象</li>
<li><code>c.most_common()[:-n-1:-1]</code>, 出现最少的n个元素</li>
<li><code>c += Counter()</code>, 移除所有元素计数为0的元素
注意: 将某元素的计数赋值为0, 并不能在计数器的元素列表中删除该元素。若要删除该元素，需要用<code>del</code>.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter(<span class="string">"12"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">1</span>&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c[<span class="string">"0"</span>]</div><div class="line"><span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">1</span>&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c[<span class="string">"0"</span>] = <span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">1</span>, <span class="string">'0'</span>: <span class="number">0</span>&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> c[<span class="string">"0"</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">1</span>&#125;)</div></pre></td></tr></table></figure>
<h1 id="5-defaultdict">5. defaultdict</h1>
<h2 id="51">5.1 介绍</h2>
<p>defaultdict类是dict类的子类，包含dict类的所有功能。与dict不同的是，在调用不存在的键值时，dict会抛出<code>KeyError</code>异常，而defaultdict会执行<code>__missing__</code>函数, 通过调用该函数来进行操作或返回值。
定义方式如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">d = defaultdict()                                   <span class="comment"># 这种定义方式返回的对象跟普通dict无异</span></div><div class="line">a = defaultdict(<span class="keyword">lambda</span>: <span class="string">"N/A"</span>)                      <span class="comment"># 定义__missing__函数</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> a[<span class="string">"0"</span>]                                        <span class="comment"># 返回"N/A", 同时a["0"]被赋值为"N/A"</span></div></pre></td></tr></table></figure>
<h2 id="52">5.2 应用场景</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = [(<span class="string">'yellow'</span>, <span class="number">1</span>), (<span class="string">'blue'</span>, <span class="number">2</span>), (<span class="string">'yellow'</span>, <span class="number">3</span>), (<span class="string">'blue'</span>, <span class="number">4</span>), (<span class="string">'red'</span>, <span class="number">1</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = defaultdict(list)                                           <span class="comment"># 若键值不存在，则赋值为[]</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> k, v <span class="keyword">in</span> s:</div><div class="line"><span class="meta">... </span>    d[k].append(v)</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d.items()</div><div class="line">[(<span class="string">'blue'</span>, [<span class="number">2</span>, <span class="number">4</span>]), (<span class="string">'red'</span>, [<span class="number">1</span>]), (<span class="string">'yellow'</span>, [<span class="number">1</span>, <span class="number">3</span>])]</div></pre></td></tr></table></figure>
<h1 id="6-orderddict">6. OrderdDict</h1>
<h2 id="61">6.1 简介</h2>
<p>使用<code>dict</code>时，Key是无序的。在对<code>dict</code>做迭代时，我们无法确定Key的顺序。如果要保持Key的顺序，可以用<code>OrderedDict</code>.
<code>OrderedDict</code>的键值顺序按照键值被插入的顺序排列，而不是Key本身的顺序。
<code>OrderdDict</code>的键值可以通过调用<code>popitem</code>函数被弹出，弹出时弹出(key, item)的键值对。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = OrderedDict(&#123;<span class="string">"one"</span>: <span class="number">1</span>&#125;)                     <span class="comment"># 可通过dict定义，也可传入可迭代对象</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="string">"zero"</span>] = <span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="string">"two"</span>] = <span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">OrderedDict([(<span class="string">'one'</span>, <span class="number">1</span>), (<span class="string">'zero'</span>, <span class="number">0</span>), (<span class="string">'two'</span>, <span class="number">2</span>)])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.popitem()                                     <span class="comment"># 弹出最后一个键值对</span></div><div class="line">(<span class="string">'two'</span>, <span class="number">2</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.popitem(last=<span class="keyword">False</span>)                           <span class="comment"># 弹出第一个键值对</span></div><div class="line">(<span class="string">'one'</span>, <span class="number">1</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">OrderedDict([(<span class="string">'zero'</span>, <span class="number">0</span>)])</div></pre></td></tr></table></figure>
<h1 id="7">7. 参考文档</h1>
<ol>
<li><a href="https://docs.python.org/2.7/library/collections.html#collections.OrderedDict" target="_blank" rel="external">8.3 collections — High-performance container datatypes</a></li>
<li><a href="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/001411031239400f7181f65f33a4623bc42276a605debf6000" target="_blank" rel="external">collections - 廖雪峰的官方教程</a></li>
</ol>
<h1 id="8">8. 后记</h1>
<p>这篇博文写了两天，感觉在翻译文档，有点枯燥。一直觉得应该多去了解Python的内置常用模块，不要求完全熟练，至少要有个印象，这样在开发中需要使用这些模块的时候，才能够想起来用它。
所以，又填完一个坑。下一个应该是unittest吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;collection是Python内建的一个实用工具包，提供一些使用的容器，用于对传统容器类型进行功能提升。&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="//blog.stdioa.com/categories/Python/"/>
    
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
      <category term="collections" scheme="//blog.stdioa.com/tags/collections/"/>
    
  </entry>
  
  <entry>
    <title>Python学习之迭代器</title>
    <link href="//blog.stdioa.com/2015/10/learning-python-iterator/"/>
    <id>//blog.stdioa.com/2015/10/learning-python-iterator/</id>
    <published>2015-10-26T07:43:00.000Z</published>
    <updated>2016-11-08T13:48:35.528Z</updated>
    
    <content type="html"><![CDATA[<p>昨晚用python写了个简单的链表，突然想起了迭代器，就随手整理一下，顺便过一下itertools模块。</p>
<a id="more"></a>
<h1 id="1">1. 简介</h1>
<p>迭代器(iterator)是Python中一种用来进行惰性迭代的数据类型，迭代器可以惰性地在需要时生成数据并返回已进行迭代，而不需要在开始进行时生成所有数据（有的时候也不可能生成所有数据，比如斐波那契数列的无穷迭代等）然后一个一个返回。</p>
<h1 id="2">2. 用法</h1>
<h2 id="21-iter">2.1 最基础的例子: iter()函数生成迭代器</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">list_ = [<span class="number">1</span>,<span class="number">2</span>]</div><div class="line">it = iter(list_)                        <span class="comment"># 返回一个迭代器</span></div><div class="line"></div><div class="line">it.next()                               <span class="comment"># 获取一个迭代器元素，返回1</span></div><div class="line">next(it)                                <span class="comment"># 使用next内建函数，等同于it.next(), 返回2</span></div><div class="line">it.next()                               <span class="comment"># 迭代结束，触发StopIteration异常</span></div><div class="line"></div><div class="line">list_ = [<span class="number">1</span>,<span class="number">2</span>]</div><div class="line">it = iter(list_)</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> it:                            <span class="comment"># 用for循环对迭代器进行循环迭代</span></div><div class="line">    <span class="keyword">print</span> x                             <span class="comment"># 迭代结束时，StopIteration不会被触发</span></div></pre></td></tr></table></figure>
<p>值得注意的是，迭代器只可向前迭代，不能向后迭代，获取之前已返回过的值（当然绝大多数的时候也没必要向后迭代）。</p>
<h2 id="22">2.2 生成器</h2>
<p><code>[x*2 for x in range(10) if x%2==0]</code>, 这段代码为列表生成式（也称作列表解析），可以将一个列表进行转化；将方括号变为圆括号，<code>(x*2 for x in range(10) if x%2==0)</code>, 则该代码变为一个生成器(generator)。
生成器可以像迭代器一样进行迭代，还可以通过生成器的成员函数和生成器内部的代码进行数据交换。</p>
<h1 id="3">3. 自定义迭代器及生成器</h1>
<h2 id="31">3.1 自定义迭代器</h2>
<p>在编写类的时候，可以通过定义类的<code>__iter__</code>函数来使类可以转化为迭代器。在<code>__iter__</code>函数结束时，会自动引发<code>StopIteration</code>异常。例:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.number = <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            <span class="keyword">yield</span> self.number</div><div class="line">            self.number += <span class="number">1</span></div><div class="line"></div><div class="line">a = Counter()</div><div class="line">it = iter(a)</div><div class="line"><span class="keyword">print</span> it.next()                 <span class="comment"># 0</span></div><div class="line"><span class="keyword">print</span> it.next()                 <span class="comment"># 1</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> num <span class="keyword">in</span> it:</div><div class="line">    <span class="keyword">print</span> num                   <span class="comment"># 因为该迭代器为无穷迭代，所以会导致死循环</span></div></pre></td></tr></table></figure>
<h2 id="32">3.2 自定义生成器</h2>
<p>可以用函数自定义生成器。例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">()</span>:</span></div><div class="line">    a, b = <span class="number">1</span>, <span class="number">1</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        <span class="keyword">yield</span> a                 <span class="comment"># 用yield函数来在迭代时返回值，在下次迭代时，自动从yield语句的下一条语句开始执行</span></div><div class="line">        a, b = b, a+b</div><div class="line"></div><div class="line">k = fib()</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</div><div class="line">    <span class="keyword">print</span> next(k)               <span class="comment"># 1 1 2 3 5 8 13 21 34 55</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> type(k)                   <span class="comment"># &lt;generator object fib at 0x0268BDF0&gt;</span></div></pre></td></tr></table></figure>
<h2 id="33">3.3 生成器的进阶用法</h2>
<p><code>generator.next()</code>用来进行迭代并获取返回值；<code>generator.close()</code>用来关闭生成器，并在下次迭代时出发StopIteration异常。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">a = fib()</div><div class="line"><span class="keyword">print</span> next(a)                   <span class="comment"># 1</span></div><div class="line">a.close()                       <span class="comment"># 关闭迭代器</span></div><div class="line"><span class="keyword">print</span> next(a)                   <span class="comment"># StopIteration</span></div></pre></td></tr></table></figure>
<p><code>generator.send(arg)</code>可以向生成器内部传递对象，<code>generator.throw(typ[,val[,tb]])</code>可以向生成器内部传递异常（包括类型，具体异常对象和Traceback）；在调用这两个函数后，生成器立刻进行迭代并返回值（或触发StopIteration）。具体操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></div><div class="line">    num = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            ret = <span class="keyword">yield</span> num</div><div class="line">        <span class="keyword">except</span> ValueError:</div><div class="line">            <span class="keyword">print</span> <span class="string">"ValueError caught"</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> ret <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            num = ret</div><div class="line">        num += <span class="number">1</span></div><div class="line"></div><div class="line">c = counter()</div><div class="line"><span class="keyword">print</span> c.next()                          <span class="comment"># 0</span></div><div class="line"><span class="keyword">print</span> c.send(<span class="number">3</span>)                         <span class="comment"># 传输3，内部yield语句返回3，然后进行下次迭代，生成4</span></div><div class="line"><span class="keyword">print</span> c.next()                          <span class="comment"># 5</span></div><div class="line">c.throw(ValueError)                     <span class="comment"># 传递异常，内部yield函数触发异常，然后进行异常处理，输出"ValueError caught"，若未处理，则异常会向上层抛出</span></div><div class="line"><span class="keyword">print</span> c.next()                          <span class="comment"># 6</span></div></pre></td></tr></table></figure>
<h1 id="4-itertools">4. itertools模块</h1>
<p>itertools是Python自带的一个模块，包含很多使用函数，用来对一个或多个可迭代对象进行操作后返回一个迭代器。具体函数列表：</p>
<ol>
<li>
<p>无限迭代器</p>
<ul>
<li><code>count(start, [step])</code>
从start开始，以后每个元素都加上step。step默认值为1。
<code>count(5)</code> -&gt; 5 6 7 …</li>
<li><code>cycle(p)</code>
迭代至p的最后一个元素之后，从p的第一个元素重新迭代。
<code>cycle('abc')</code> -&gt; a b c a b c …</li>
<li><code>repeat(elem [,n])</code>
无限重复或重复n次返回elem。
<code>repeat(&quot;Ah&quot;, 3)</code> -&gt; “Ah” “Ah” “Ah”</li>
</ul>
</li>
<li>
<p>在最短的序列结束迭代时停止迭代</p>
<ul>
<li>chain(p, q, …)
迭代至序列p的最后一个元素后，从q的第一个元素开始，直到所有序列终止。
<code>chain(&quot;ABC&quot;, &quot;DEF&quot;)</code> -&gt; A B C D E F</li>
<li><code>compress(data, selectors)</code>
如果bool(selectors[n])为True，则next()返回data[n]，否则跳过data[n]。
<code>compress('ABCDEF', [1,0,1,0,1,1])</code> -&gt; A C E F</li>
<li><code>dropwhile(pred, seq)</code>
当pred对seq[n]的调用返回False时才开始迭代。
<code>dropwhile(lambda x: x&lt;5, [1,4,6,4,1])</code> -&gt; 6 4 1</li>
<li><code>takewhile(pred, seq)</code>
dropwhile的相反版本。
<code>takewhile(lambda x: x&lt;5, [1,4,6,4,1])</code> -&gt; 1 4</li>
<li><code>ifilter(pred, seq)</code>
内建函数filter的迭代器版本。
<code>ifilter(lambda x: x%2, range(10))</code> -&gt; 1 3 5 7 9</li>
<li><code>ifilterfalse(pred, seq)</code>
ifilter的相反版本。
<code>ifilterfalse(lambda x: x%2, range(10))</code> -&gt; 0 2 4 6 8</li>
<li><code>imap(func, p, q, ...)</code>
内建函数map的迭代器版本。
<code>imap(pow, (2,3,10), (5,2,3))</code> -&gt; 32 9 1000</li>
<li><code>starmap(func, seq)</code>
将seq的每个元素以变长参数(*args)的形式调用func。
<code>starmap(pow, [(2,5), (3,2), (10,3)])</code> -&gt; 32 9 1000</li>
<li><code>izip(p, q, ...)</code>
内建函数zip的迭代器版本。
<code>izip('ABCD', 'xy')</code> -&gt; Ax By</li>
<li><code>izip_longest(p, q, ..., fillvalue=None)</code>
izip的取最长序列的版本，短序列将填入fillvalue。
<code>izip_longest('ABCD', 'xy', fillvalue='-')</code> -&gt; Ax By C- D-</li>
<li><code>tee(it, n)</code>
返回n个迭代器it的复制迭代器。</li>
<li><code>groupby(iterable[, keyfunc])</code>
这个函数功能类似于SQL的分组。使用groupby前，首先需要使用相同的keyfunc对iterable进行排序，比如调用内建的sorted函数。然后，groupby返回迭代器，每次迭代的元素是元组(key值, iterable中具有相同key值的元素的集合的子迭代器)。或许看看Python的排序指南对理解这个函数有帮助。
<code>groupby([0, 0, 0, 1, 1, 1, 2, 2, 2])</code> -&gt; (0, (0 0 0)) (1, (1 1 1)) (2, (2 2 2))</li>
</ul>
</li>
<li>
<p>组合迭代器</p>
<ul>
<li><code>product(p, q, ... [repeat=1])</code>
生成笛卡尔积。
<code>product('ABCD', repeat=2)</code> --&gt; AA AB AC AD BA BB BC BD CA CB CC CD DA DB DC DD</li>
<li><code>permutations(p[, r])</code>
生成全排列。
<code>permutations('ABCD', 2)</code> --&gt; AB AC AD BA BC BD CA CB CD DA DB DC</li>
<li><code>combinations(p, r)</code>
生成组合。
<code>combinations('ABCD', 2)</code> --&gt; AB AC AD BC BD CD</li>
<li><code>combinations_with_replacement()</code>
生成排列元素(p, q), 且p&lt;q.
<code>combinations_with_replacement('ABCD', 2)</code> --&gt; AA AB AC AD BB BC BD CC CD DD</li>
</ul>
</li>
</ol>
<p>部分文字来源：<a href="http://www.cnblogs.com/huxi/archive/2011/07/01/2095931.html" target="_blank" rel="external">http://www.cnblogs.com/huxi/archive/2011/07/01/2095931.html</a></p>
<h1 id="5">5. 参考文档</h1>
<ol>
<li><a href="https://docs.python.org/2.7/library/itertools.html#module-itertools" target="_blank" rel="external">itertools - Python Doc</a></li>
<li><a href="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/00138681965108490cb4c13182e472f8d87830f13be6e88000" target="_blank" rel="external">生成器 - 廖雪峰的Python教程</a></li>
<li><a href="http://blog.csdn.net/bluebird_237/article/details/38894617" target="_blank" rel="external">Python 迭代器 &amp; __iter__方法</a></li>
<li><a href="http://www.cnblogs.com/huxi/archive/2011/07/01/2095931.html" target="_blank" rel="external">Python函数式编程指南（三）：迭代器</a></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;昨晚用python写了个简单的链表，突然想起了迭代器，就随手整理一下，顺便过一下itertools模块。&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="//blog.stdioa.com/categories/Python/"/>
    
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
      <category term="迭代器" scheme="//blog.stdioa.com/tags/%E8%BF%AD%E4%BB%A3%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>Python学习之上下文管理</title>
    <link href="//blog.stdioa.com/2015/10/learning-python-context-management/"/>
    <id>//blog.stdioa.com/2015/10/learning-python-context-management/</id>
    <published>2015-10-22T12:00:00.000Z</published>
    <updated>2016-11-08T13:48:35.523Z</updated>
    
    <content type="html"><![CDATA[<p>最近突发奇想，想写一个能改变当前输出环境，输出彩色文字的上下文管理器，于是学习了一下上下文管理。</p>
<a id="more"></a>
<h1 id="1">1. 简介</h1>
<p>上下文管理器(context manager)是Python2.5开始支持的一种语法，用于规定某个对象的使用范围。一旦进入或者离开该使用范围，会有特殊操作被调用 (比如为对象分配或者释放内存)。一个最简单的例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> file(<span class="string">"a.txt"</span>, <span class="string">"r"</span>) <span class="keyword">as</span> f:</div><div class="line">    s = f.read()</div><div class="line">    <span class="keyword">print</span> f.closed                  <span class="comment"># 此时文件是打开的</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> f.closed                      <span class="comment"># 变量s和f依然存在，但此时f已关闭</span></div></pre></td></tr></table></figure>
<h1 id="2">2. 编写上下文管理器</h1>
<p>为一个类编写上下文管理器时，需要定义类的<code>__enter__</code>和<code>__exit__</code>函数。</p>
<h2 id="21-enter-">2.1 __enter__函数</h2>
<p><code>__enter__</code>函数规定如下：</p>
<blockquote>
<p>contextmanager.__enter__()
Enter the runtime context and return either this object or another object related to the runtime context. The value returned by this method is bound to the identifier in the as clause of with statements using this context manager.
进入当前上下文，并返回当前对象或另一个与当前上下文相关的对象。被该函数返回的变量会通过该上下文管理器与with文法中as后的声明所绑定。</p>
</blockquote>
<p>例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BracketAdder</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment"># do something with self and runtime context</span></div><div class="line">        sys.stdout.write(<span class="string">"("</span>)           <span class="comment"># 输出左括号</span></div><div class="line">        <span class="keyword">return</span> self</div><div class="line"></div><div class="line">    <span class="comment"># __exit__函数略</span></div><div class="line"></div><div class="line"><span class="keyword">with</span> BracketAdder() <span class="keyword">as</span> ba:</div><div class="line">    <span class="comment"># do_something</span></div></pre></td></tr></table></figure>
<h2 id="22-exit-">2.2 __exit__函数</h2>
<p><code>__exit__</code>函数格式如下:</p>
<blockquote>
<p>contexmanager.__exit__(exc_type, exc_val, exc_tb)</p>
</blockquote>
<p><em>文档太长懒得翻译了</em>_(:зゝ∠)_</p>
<p>如果代码块中出现异常，<code>exc_type</code>为异常类型，<code>exc_val</code>为该异常，<code>exc_tb</code>为traceback.<code>__exit__</code>函数应返回一个bool类型，若返回值为<code>True</code>, 则在代码块及<code>__exit__</code>函数运行结束后不会抛出任何异常，然后立即执行后面的代码；若返回值为<code>False</code>，则在<code>__exit__</code>函数运行结束后抛出异常。<br>
若代码块中未出现异常，则三个变量均为<code>None</code>.
例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BracketAdder</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="comment"># __enter__函数略</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span><span class="params">(self, exc_type, exc_val, exc_tb)</span>:</span></div><div class="line">        <span class="comment"># do something with self and runtime context</span></div><div class="line">        sys.stdout.write(<span class="string">')'</span>)</div><div class="line">        <span class="keyword">if</span> exc_type == NameError:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="keyword">with</span> BracketAdder():</div><div class="line">    <span class="keyword">print</span> a                    <span class="comment"># 若执行这一条引发NameError异常，则异常不会被抛出</span></div><div class="line">    a = <span class="number">1</span>/<span class="number">0</span>                    <span class="comment"># 若执行这一条引发ZeroDivisionError, 则异常会被抛出</span></div></pre></td></tr></table></figure>
<h1 id="3">3. 综合示例</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf-8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CManager</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.in_context = <span class="keyword">False</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span><span class="params">(self)</span>:</span></div><div class="line">        self.in_context = <span class="keyword">True</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"I'm entering the context"</span></div><div class="line">        <span class="keyword">return</span> self</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span><span class="params">(self, exc_type, exc_val, exc_tb)</span>:</span></div><div class="line">        self.in_context = <span class="keyword">False</span></div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">"I'm leaving the context"</span></div><div class="line">        </div><div class="line">        <span class="keyword">if</span> exc_type == NameError:       <span class="comment"># 拦截NameError异常</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"I'm &#123;status&#125;in the context."</span>.format(</div><div class="line">                    status=<span class="string">""</span> <span class="keyword">if</span> self.in_context <span class="keyword">else</span> <span class="string">"not "</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">with</span> CManager() <span class="keyword">as</span> ba:</div><div class="line">    ba.show()</div><div class="line">    <span class="comment"># blahblah</span></div><div class="line">    <span class="keyword">raise</span> NameError                     <span class="comment"># 触发NameError异常，代码块后面的语句实际不会执行，而该异常会在__exit__函数中被拦截</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'k'</span></div><div class="line"></div><div class="line">ba.show()</div></pre></td></tr></table></figure>
<p>程序输出:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">I&apos;m entering the context</div><div class="line">I&apos;m in the context.</div><div class="line">I&apos;m leaving the context</div><div class="line">I&apos;m not in the context.</div></pre></td></tr></table></figure>
<h1 id="4">4. 参考文档</h1>
<ol>
<li><a href="https://docs.python.org/2.7/library/stdtypes.html#index-37" target="_blank" rel="external">Context Manager Types - Python Doc</a></li>
<li><a href="http://www.cnblogs.com/vamei/archive/2012/11/23/2772445.html" target="_blank" rel="external">Python深入02 上下文管理器</a></li>
<li><a href="http://python.jobbole.com/82494/" target="_blank" rel="external">浅谈 Python 的 with 语句</a></li>
</ol>
<h1 id="5">5. 后记</h1>
<p>这些小知识点平时只是粗略的看一下，只能达到会用的程度，有时候觉得只有自己整理一遍才能真正理解它们，才能熟练运用。<br>
所以…又填完一个坑。周末简单写写PyQt4吧…</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近突发奇想，想写一个能改变当前输出环境，输出彩色文字的上下文管理器，于是学习了一下上下文管理。&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="//blog.stdioa.com/categories/Python/"/>
    
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
      <category term="上下文管理" scheme="//blog.stdioa.com/tags/%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Python学习之virtualenv</title>
    <link href="//blog.stdioa.com/2015/10/learning-python-virtualenv/"/>
    <id>//blog.stdioa.com/2015/10/learning-python-virtualenv/</id>
    <published>2015-10-22T02:15:00.000Z</published>
    <updated>2016-11-08T13:48:35.543Z</updated>
    
    <content type="html"><![CDATA[<p>用过virtualenv的人都说好，可是我没有具体使用过，所以尝试了一下，用完我也说好~233333</p>
<a id="more"></a>
<h1 id="1">1. 简介</h1>
<p>virtualenv是一个python库，用于创建独立python开发及运行环境。一般linux环境下如果在全局用pip安装模块时需要使用sudo命令，可是在共享主机上将root权限交给一般用户是不显示而且不安全的。可是有了virtualenv, 普通用户就可以创建一个虚拟环境，然后在虚拟环境中以普通用户权限安装模块，更改环境变量，进行开发和运行python程序而不会影响系统环境的环境变量和Python模块。</p>
<h1 id="2-virtualenv">2. 创建virtualenv环境</h1>
<p>输入<code>virtualenv venv</code>创建名为venv的虚拟环境。
创建虚拟环境的常用选项：</p>
<blockquote>
<p>–no-site-packages 不使用系统中的site packages
–system-site-package 使用系统中的site packages <em>(据说是默认，但在我这默认是不使用的)</em>
-p PYTHON_EXE, --python=PYTHON_EXE 使用指定的python解释器，这里的PYTHON_EXE在Windows下需要用绝对路径，比如C:\Python27\python.exe\</p>
</blockquote>
<p>当然，也可以使用虚拟环境和系统配置文件来设置virtualenv默认创建选项，详情见<a href="http://virtualenv-chinese-docs.readthedocs.org/en/latest/#id7" target="_blank" rel="external">这里</a>。</p>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">G:\&gt;virtualenv venv</div><div class="line">New python executable in venv\Scripts\python.exe</div><div class="line">Installing setuptools, pip, wheel...done.</div></pre></td></tr></table></figure>
<h1 id="3">3. 进入及退出虚拟环境</h1>
<p>进入venv目录，Linux下输入<code>bin/activate</code>, Windows下输入<code>Scripts\activate</code>进入虚拟环境。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">G:\venv&gt;Scripts\activate</div><div class="line">(venv) G:\venv&gt;</div></pre></td></tr></table></figure>
<p>进入环境后，输入<code>deactivate</code>退出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(venv) G:\venv&gt;deactivate</div><div class="line">G:\venv&gt;</div></pre></td></tr></table></figure>
<h1 id="4">4. 使用虚拟环境</h1>
<h2 id="41">4.1 安装第三方模块</h2>
<p>安装过程与平时相符（比如使用<code>pip install</code>), 只不过安装后的包会存储在虚拟环境中。</p>
<h2 id="42">4.2 设置环境变量</h2>
<p>Linux下输入<code>export VAR1=&quot;value1&quot;</code>, Windows下输入<code>set VAR1=value1</code>来设置虚拟环境的环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(venv) C:\Users\Stdio\Desktop\temp\venv&gt;set VAR1=value1</div><div class="line"></div><div class="line">(venv) C:\Users\Stdio\Desktop\temp\venv&gt;echo %VAR1%</div><div class="line">value1</div></pre></td></tr></table></figure>
<p>环境变量设置成功后，即可在Python程序中利用虚拟环境的环境变量进行程序配置（比如flask中的<code>app.config.from_envvar(&quot;FLASK_SETTINGS&quot;)</code>）。该环境变量只在虚拟环境中有效，退出虚拟环境后环境变量即消失。</p>
<h1 id="5">5. 参考文档</h1>
<ol>
<li><a href="http://virtualenv.readthedocs.org/en/latest/index.html" target="_blank" rel="external">Virtualenv - virtualenv 13.1.2 documentation</a></li>
<li><a href="http://virtualenv.readthedocs.org/en/latest/index.html" target="_blank" rel="external">Virtualenv - virtualenv 1.7.1.2.post1 documentation 中文版</a></li>
<li><a href="http://flask123.sinaapp.com/article/39/" target="_blank" rel="external">virtualenv入门教程</a></li>
<li><a href="http://www.cnblogs.com/tk091/p/3700013.html" target="_blank" rel="external">virtualenv – python虚拟沙盒</a></li>
<li><a href="http://www.nowamagic.net/academy/detail/1330228" target="_blank" rel="external">用virtualenv建立多个Python独立开发环境</a></li>
</ol>
<h1 id="6">6. 后记</h1>
<p>又填完一个坑，本来打算昨天就写好的，结果昨天没写完…</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;用过virtualenv的人都说好，可是我没有具体使用过，所以尝试了一下，用完我也说好~233333&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="//blog.stdioa.com/categories/Python/"/>
    
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
      <category term="virtualenv" scheme="//blog.stdioa.com/tags/virtualenv/"/>
    
  </entry>
  
  <entry>
    <title>Python学习之logging</title>
    <link href="//blog.stdioa.com/2015/10/learning-python-logging/"/>
    <id>//blog.stdioa.com/2015/10/learning-python-logging/</id>
    <published>2015-10-21T08:00:00.000Z</published>
    <updated>2016-11-08T13:48:35.533Z</updated>
    
    <content type="html"><![CDATA[<p>以前写代码的时候，所有信息包括调试信息全部输出在屏幕上，有的时候会看起来乱糟糟的，这时就需要logging模块来记录信息或生成日志文件。</p>
<a id="more"></a>
<h1 id="1">1. 简介</h1>
<p>logging是一个用来记录日志信息的模块，它可以输出信息到stdout或者自定的日志文件中。</p>
<h1 id="2">2. 基本</h1>
<p>输出信息：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">logging.debug(<span class="string">"A debug message"</span>)</div><div class="line">logging.info(<span class="string">"A info message"</span>)</div><div class="line">logging.warn(<span class="string">"A warning message"</span>)</div><div class="line">logging.error(<span class="string">"A error message"</span>)</div><div class="line">logging.critical(<span class="string">"A critical message"</span>)</div></pre></td></tr></table></figure>
<p>日志级别：
logging默认的日志级别为WARNING，在当前级别下，只有warning及以上的日志可以被记录。logging的级别可通过<code>logging.basicConfig</code>或<code>logging.setLevel</code>来修改。级别大小关系为CRITICAL(50) &gt; ERROR(40) &gt; WARNING(30) &gt; INFO(20) &gt; DEBUG(10) &gt; NOTSET(0), 需要注意的是，一旦记录信息，logging的日志级别就不可再更改。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>logging.basicConfig(level=logging.INFO)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>logging.info(<span class="string">"Info"</span>)</div><div class="line">INFO:root:Info</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>logging.basicConfig(level=logging.DEBUG)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>logging.debug(<span class="string">"Debug"</span>)                      <span class="comment"># 没有输出</span></div></pre></td></tr></table></figure>
<h1 id="3">3. 日志格式设置及日志文件操作</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> logging</div><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line">logging.basicConfig(format=<span class="string">"%(asctime)s %(levelname)s %(message)s"</span>,</div><div class="line">                        datefmt=<span class="string">"%Y %b %d %H:%M:%S"</span>,</div><div class="line">                        filename=<span class="string">"./log.log"</span>,</div><div class="line">                        filemode=<span class="string">"w"</span>,               <span class="comment"># default is "a"</span></div><div class="line">                        level=logging.INFO)</div><div class="line"></div><div class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</div><div class="line">        logging.log(i*<span class="number">10</span>, <span class="string">"a log"</span>)                  <span class="comment"># logging.log(level, msg)</span></div><div class="line">        time.sleep(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>log.log输出(可以用tail -f命令实时查看):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">2015 Oct 21 14:41:36 INFO a log</div><div class="line">2015 Oct 21 14:41:37 WARNING a log</div><div class="line">2015 Oct 21 14:41:38 ERROR a log</div><div class="line">2015 Oct 21 14:41:41 CRITICAL a log</div><div class="line">2015 Oct 21 14:41:42 INFO a log</div><div class="line">2015 Oct 21 14:41:43 WARNING a log</div><div class="line">2015 Oct 21 14:41:44 ERROR a log</div><div class="line">2015 Oct 21 14:41:45 CRITICAL a log</div></pre></td></tr></table></figure>
<h1 id="4">4. 将日志输出到多个流中</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> logging</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="comment"># 可以通过logging.basicConfig设置一个默认流</span></div><div class="line"></div><div class="line">console = logging.StreamHandler(stream=sys.stdout)                    <span class="comment"># 默认流为sys.stderr</span></div><div class="line">console.setLevel(logging.INFO)</div><div class="line">formatter = logging.Formatter(<span class="string">'%(name)-12s: %(levelname)-8s %(message)s'</span>)</div><div class="line">console.setFormatter(formatter)</div><div class="line">logging.getLogger().addHandler(console)</div><div class="line"></div><div class="line">files = logging.FileHandler(<span class="string">"log2.log"</span>, mode=<span class="string">"a"</span>, encoding=<span class="string">"utf-8"</span>)   <span class="comment"># 设置文件流</span></div><div class="line">files.setLevel(logging.WARNING)</div><div class="line">formatter = logging.Formatter(<span class="string">"%(levelname)s %(message)s"</span>)</div><div class="line">files.setFormatter(formatter)</div><div class="line">logging.getLogger().addHandler(files)</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>):</div><div class="line">    logging.log(i*<span class="number">10</span>, logging.getLevelName(i*<span class="number">10</span>).lower())</div></pre></td></tr></table></figure>
<h1 id="5-logger">5. 设置多个logger以记录不同信息</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf-8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> logging</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line">log1 = logging.Logger(<span class="string">"0.0"</span>)</div><div class="line"></div><div class="line">console = logging.StreamHandler(sys.stdout)                               <span class="comment"># 默认流为sys.stderr</span></div><div class="line">console.setLevel(logging.INFO)</div><div class="line">formatter = logging.Formatter(<span class="string">'%(name)-12s: %(levelname)-8s %(message)s'</span>)</div><div class="line">console.setFormatter(formatter)</div><div class="line">log1.addHandler(console)</div><div class="line"></div><div class="line">log2 = logging.Logger(<span class="string">"-.-"</span>)</div><div class="line"></div><div class="line">files = logging.FileHandler(<span class="string">"log2.log"</span>, mode=<span class="string">"a"</span>, encoding=<span class="string">"utf-8"</span>)     <span class="comment"># 设置文件流</span></div><div class="line">files.setLevel(logging.WARNING)</div><div class="line">formatter = logging.Formatter(<span class="string">"%(name)s %(levelname)s %(message)s"</span>)</div><div class="line">files.setFormatter(formatter)</div><div class="line">log2.addHandler(files)</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>):</div><div class="line">    log1.log(i*<span class="number">10</span>, logging.getLevelName(i*<span class="number">10</span>).lower())</div><div class="line">    log2.log(i*<span class="number">10</span>, logging.getLevelName(i*<span class="number">10</span>).lower())</div><div class="line"></div><div class="line">logging.critical(<span class="string">"AHHH! I'm the root logger but you forget me!"</span>)        <span class="comment"># 默认使用logging时logger name为"root"</span></div><div class="line">logging.getLogger(<span class="string">"root"</span>).info(<span class="string">"Of course not!"</span>)</div></pre></td></tr></table></figure>
<h1 id="5">5. 参考文档</h1>
<ol>
<li><a href="https://docs.python.org/2.7/howto/logging.html" target="_blank" rel="external">Logging HOWTO</a></li>
<li><a href="http://www.cnblogs.com/dkblog/archive/2011/08/26/2155018.html" target="_blank" rel="external">python 的日志logging模块学习</a></li>
</ol>
<h1 id="6">6. 后记</h1>
<p>又填完一个坑，最近要填的坑好多…</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以前写代码的时候，所有信息包括调试信息全部输出在屏幕上，有的时候会看起来乱糟糟的，这时就需要logging模块来记录信息或生成日志文件。&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="//blog.stdioa.com/categories/Python/"/>
    
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
      <category term="logging" scheme="//blog.stdioa.com/tags/logging/"/>
    
  </entry>
  
  <entry>
    <title>随手记之Git</title>
    <link href="//blog.stdioa.com/2015/10/essay-git/"/>
    <id>//blog.stdioa.com/2015/10/essay-git/</id>
    <published>2015-10-14T10:28:00.000Z</published>
    <updated>2016-11-08T13:48:35.485Z</updated>
    
    <content type="html"><![CDATA[<p>从一年前开始使用Git, 一直没系统整理过Git的命令，前几天在部署代码的时候出了问题不知道该如何解决，于是决定整理一份Git的使用方法。本博文会持续更新。</p>
<a id="more"></a>
<h1 id="1-git">1. 什么是Git</h1>
<p>Linus大神写的分布式版本控制工具，具体请访问官网<a href="http://git-scm.com" target="_blank" rel="external">http://git-scm.com</a>.
Wikipedia链接: <a href="https://en.wikipedia.org/wiki/Git_(software)" target="_blank" rel="external">Git (software)</a></p>
<h1 id="2">2. 基本操作</h1>
<p>初始化版本仓库: <code>git init</code>
从远程仓库克隆: <code>git clone [url] [repo_name]</code><br>
例: <code>git clone https://github.com/user/repo my_repo</code></p>
<p><img src="/pics/lifecycle.png" alt="life-cycle"></p>
<center><small>文件的状态变化周期</small></center>
<p>检查文件状态: <code>git status</code>
状态简览: <code>git status -s</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ git status -s</div><div class="line"> M README</div><div class="line">MM Rakefile</div><div class="line">A  lib/git.rb</div><div class="line">M  lib/simplegit.rb</div><div class="line">?? LICENSE.txt</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">字母</th>
<th style="text-align:center">所代表的状态</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">??</td>
<td style="text-align:center">未追踪</td>
</tr>
<tr>
<td style="text-align:left">   M</td>
<td style="text-align:center">已修改，未暂存</td>
</tr>
<tr>
<td style="text-align:left">MM</td>
<td style="text-align:center">修改后暂存，然后又修改</td>
</tr>
<tr>
<td style="text-align:left">A</td>
<td style="text-align:center">新添加到暂存区</td>
</tr>
<tr>
<td style="text-align:left">M</td>
<td style="text-align:center">修改后添加到暂存区</td>
</tr>
</tbody>
</table>
<p>忽略文件： 编辑<code>.gitignore</code>文件。<br>
文件 .gitignore 的格式规范如下：</p>
<ul>
<li>所有空行或者以 ＃ 开头的行都会被 Git 忽略。</li>
<li>可以使用标准的 glob 模式匹配。</li>
<li>匹配模式可以以（/）开头防止递归。</li>
<li>匹配模式可以以（/）结尾指定目录。</li>
<li>要忽略指定模式以外的文件或目录，可以在模式前加上惊叹号（!）取反。
具体例子见<a href="http://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E8%AE%B0%E5%BD%95%E6%AF%8F%E6%AC%A1%E6%9B%B4%E6%96%B0%E5%88%B0%E4%BB%93%E5%BA%93" target="_blank" rel="external">Git-基础</a>。</li>
</ul>
<p>查看尚未暂存的文件更新部分: <code>git diff</code>
查看已暂存的文件更新的部分: <code>git diff --staged</code></p>
<p>提交更新: <code>git commit</code>
<code>git commit -a</code> = <code>git add --all; git commit</code>
提交时输入单行信息(Commit log): <code>git commit -m</code></p>
<p>添加文件: <code>git add [filename]</code>, 使git跟踪文件
删除文件: <code>git rm [filename]</code>, 使git停止跟踪文件并将文件删除
停止跟踪文件: <code>git rm --cached</code>, 停止跟踪但不删除文件
移动文件: <code>git mv</code>, 规则和<code>mv</code>基本相同</p>
<p>查看提交历史: <code>git log</code>
显示每次提交的内容差异: <code>git log -p</code>
查看每次提交的简略统计信息: <code>git log --stat</code>
查看每次提交的代码更改详情：<code>git log --cc</code>
显示ASCII图形表示的分支合并历史: <code>git log --graph</code>
粗略显示: <code>git log --oneline --graph --decorate --all</code></p>
<p>更多请输入<code>git log --help</code>查看man page.</p>
<p>更改上次提交: <code>git commit --amend</code>
取消暂存: <code>git reset HEAD [filename]</code>
取消暂存并丢弃现有的更改: <code>git reset HEAD --hard [filename]</code>, 未提交的更改会丢失
撤销对文件的更改: <code>git checkout -- [filename]</code>, 未提交的更改会丢失</p>
<p><code>git push origin --delete [branch]</code>, 删除远程分支</p>
<h1 id="3">3. 分支操作</h1>
<p><code>git branch [branch]</code>, 在当前引用上建立新分支
<code>git checkout -b [branch]</code>, 建立新分支并检出到该分支上</p>
<p>commit引用方式:</p>
<ul>
<li>
<p>直接hash引用: <code>d921970aadf03b3cf0e71becdaab3147ba71cdef</code>, <code>d921970</code></p>
</li>
<li>
<p>分支引用: <code>HEAD</code>, <code>master</code></p>
</li>
<li>
<p>相对引用: <code>HEAD^</code>, <code>HEAD^^</code>, <code>HEAD~2</code></p>
</li>
<li>
<p>若<code>a</code>是一个合并提交，有两个父引用，则<code>a^</code>为a的第一父引用，<code>a^2</code>为a的第二父引用。</p>
</li>
<li>
<p>条件引用: <code>master@{yesterday}</code>, <code>master@{1.week.before}</code></p>
</li>
<li>
<p>引用区间:</p>
<ul>
<li><code>refA..refB</code>选择从refA和refB的共同祖先开始直到refB的所有提交。例:</li>
</ul>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">若 1 - 2 - 3 - 4 ← refA</div><div class="line">         \ 5 - 6 ← refB</div><div class="line">refA..refB 即为6 5, refB..refA 即为4 3.</div><div class="line">origin/master..master为master分支上还未提交到远端的所有引用</div></pre></td></tr></table></figure>
<ul>
<li>区间筛选，例：以下三条命令等价：
<code>$ git log refA..refB</code>
<code>$ git log ^refA refB</code>
<code>$ git log refB --not refA</code></li>
<li><code>refA...refB</code>选择出被两个引用中的一个包含但又不被两者同时包含的提交，即<code>refA..refB</code>+<code>refB..refA</code></li>
</ul>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ git log --left-to-right refA...refB</div><div class="line">&lt; 4</div><div class="line">&lt; 3</div><div class="line">&gt; 6</div><div class="line">&gt; 5</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="4">4. 工作储藏</h1>
<p><code>git stash &quot;comments&quot;</code>, 储藏所有工作，包括已添加的和已更改未添加的
<code>git stash apply stash@{0}</code>, 恢复储藏，可能会产生冲突，解决冲突后<code>git add</code>添加
<code>git stash list</code>, 列出储藏栈
<code>git stash show [stashname]</code>, 查看储藏的更改
<code>git stash pop</code>, 应用栈顶储藏并弹出储藏
<code>git stash drop [stashname]</code>, 删除储藏
<code>git stash branch [branchname]</code>, 应用储藏到某分支并切换到该分支
<code>git stash --keep-index</code>, 只储藏已更改未添加的改动，不储藏 已添加的
<code>git stash --include-untracked</code>, 储藏未追踪的文件（未追踪文件）并将其从工作目录中删除
<code>git stash --all</code>, 贮藏所有文件</p>
<h1 id="5-git-reset">5. git reset</h1>
<p><code>git reset --soft HEAD^</code>, 将HEAD指针及当前分支指针指向HEAD^, 工作目录中所有的文件均添加暂存(staged), 类似“撤销<code>git commit</code>命令”，但如果重新提交，会创造一个hash不同的commit，即时提交内容完全相同。
<code>git reset --mixed HEAD^</code>, 将HEAD指针及当前分支指针指向HEAD^, 工作目录中的更改未暂存(modified but not staged), 类似“撤销<code>git add</code>和<code>git commit</code>命令”
<code>git reset --hard HEAD^</code>, 将HEAD指针及当前分支指针指向HEAD^, 工作目录中的更改完全丢失，相当于“撤销更改, <code>git add</code>和<code>git commit</code>”.</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;从一年前开始使用Git, 一直没系统整理过Git的命令，前几天在部署代码的时候出了问题不知道该如何解决，于是决定整理一份Git的使用方法。本博文会持续更新。&lt;/p&gt;
    
    </summary>
    
      <category term="随手记" scheme="//blog.stdioa.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
      <category term="Git" scheme="//blog.stdioa.com/tags/Git/"/>
    
      <category term="编程工具" scheme="//blog.stdioa.com/tags/%E7%BC%96%E7%A8%8B%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>随手记 - 用国内镜像加速pip</title>
    <link href="//blog.stdioa.com/2015/09/essay-pip-acceleration/"/>
    <id>//blog.stdioa.com/2015/09/essay-pip-acceleration/</id>
    <published>2015-09-29T15:01:00.000Z</published>
    <updated>2016-11-08T13:48:35.491Z</updated>
    
    <content type="html"><![CDATA[<p>原来Windows和Linux更改镜像源的方式是不一样的啊。</p>
<a id="more"></a>
<h1 id="1">1. 引子</h1>
<p>偶然发现USTC有一个pypi的源(<a href="http://mirrors.ustc.edu.cn/pypi/" target="_blank" rel="external">在这里</a>)，照着USTC给的<a href="https://lug.ustc.edu.cn/wiki/mirrors/help/pypi" target="_blank" rel="external">镜像使用帮助</a>更改镜像源无果。今天闲来无事就多搜了一下。</p>
<h1 id="2">2. 过程</h1>
<p>USTC的镜像使用帮助里说，将<code>index-url = https://pypi.mirrors.ustc.edu.cn/simple</code>添加到<code>~/.pip/pip.conf</code>文件中，按照此思路看，如果我在Windows下使用的话，应该将配置信息添加到<code>C:\Users\Stdio\.pip\pip.conf</code>文件中。然而添加后并没有什么卵用。今天看见一个<a href="http://blog.csdn.net/sasoritattoo/article/details/10020547" target="_blank" rel="external">博文</a>说文件设置路径应为<code>%HOME%\pip\pip.ini</code>，于是试了一下（绝对路径为<code>C:\Users\Stdio\pip\pip.ini</code>），成功。用了USTC的源，装个软件速度简直飞起︿(￣︶￣)︿<br>
弄好以后多了个心眼，去看看官方怎么说，于是找到了pip的Documentation（<a href="https://pip.pypa.io/en/stable/user_guide/#configuration" target="_blank" rel="external">在这里</a>）里面讲述了配置文件所在位置。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">Config file</div><div class="line">pip allows you to set all command line option defaults in a standard ini style config file.</div><div class="line"></div><div class="line">The names and locations of the configuration files vary slightly across platforms. You may have per-user, per-virtualenv or site-wide (shared amongst all users) configuration:</div><div class="line"></div><div class="line">Per-user:</div><div class="line"></div><div class="line">On Unix the default configuration file is: $HOME/.config/pip/pip.conf which respects the XDG<span class="emphasis">_CONFIG_</span>HOME environment variable.</div><div class="line">On Mac OS X the configuration file is $HOME/Library/Application Support/pip/pip.conf.</div><div class="line">On Windows the configuration file is %APPDATA%\pip\pip.ini.</div><div class="line">There are also a legacy per-user configuration file which is also respected, these are located at:</div><div class="line"></div><div class="line">On Unix and Mac OS X the configuration file is: $HOME/.pip/pip.conf</div><div class="line">On Windows the configuration file is: %HOME%\pip\pip.ini</div><div class="line">You can set a custom path location for this config file using the environment variable PIP<span class="emphasis">_CONFIG_</span>FILE.</div><div class="line"></div><div class="line">Inside a virtualenv:</div><div class="line"></div><div class="line">On Unix and Mac OS X the file is $VIRTUAL_ENV/pip.conf</div><div class="line">On Windows the file is: %VIRTUAL_ENV%\pip.ini</div></pre></td></tr></table></figure>
<p>于是自己将配置文件放在了<code>%APPDATA%\pip\pip.ini</code>，即<code>C:\Users\Stdio\AppData\Roaming\pip\pip.ini</code>下，经实验，加速成功。
经测试，系统层面的全局设置会影响到virtualenv建立的虚拟环境设置，所以可以通过设置虚拟环境的配置文件来更改虚拟环境设置，设置文件就放在虚拟环境根目录下就好了。</p>
<h1 id="3">3. 瞎写</h1>
<p>改了软件源以后为了做测试升级了numpy，然后编译用了半天中间电脑卡到死，现在它还在我的腿上发烫真是伤不起- -<br>
写的东西越来越没有营养了，就当是写着玩顺带积累一下知识吧。如果不出意外的话，下一篇应该是关于Python Qt Creater和Qt GUI设计的小文章0.0也许是virtualenv的随手记吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;原来Windows和Linux更改镜像源的方式是不一样的啊。&lt;/p&gt;
    
    </summary>
    
      <category term="随手记" scheme="//blog.stdioa.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
      <category term="python" scheme="//blog.stdioa.com/tags/python/"/>
    
      <category term="pip" scheme="//blog.stdioa.com/tags/pip/"/>
    
  </entry>
  
  <entry>
    <title>点点技能点之Ajax</title>
    <link href="//blog.stdioa.com/2015/09/essay-ajax/"/>
    <id>//blog.stdioa.com/2015/09/essay-ajax/</id>
    <published>2015-09-22T13:07:00.000Z</published>
    <updated>2016-11-08T13:48:35.475Z</updated>
    
    <content type="html"><![CDATA[<p>之前自己没怎么写过前端，一直以为Ajax写起来很麻烦，也没怎么接触Ajax，今天写了个小网页用到了Ajax，感觉它并不是想象的那么复杂，写完网页随手总结一下。（喂我这个技能点是不是点的太晚了啊！）</p>
<a id="more"></a>
<h1 id="1">1. 引子</h1>
<p>没啥可写的…</p>
<h1 id="2">2. 科普</h1>
<p><a href="http://www.w3school.com.cn/ajax/index.asp" target="_blank" rel="external">W3School - Ajax教程</a>，就这个吧，科普完毕。</p>
<h1 id="3">3. 笔记</h1>
<h2 id="31-ajax">3.1 Ajax的特点</h2>
<p>Ajax为Asynchronous Javascript And XML的缩写，即异步JS与XML，因为它具有异步特性，所以我们可以在网页加载中或加载结束的任意时刻使用，通过与服务器进行少量数据交换来实现网页异步更新。利用Ajax可以直接更改网页的一部分来动态刷新网页，而不需要刷新整个网页。</p>
<h2 id="32">3.2 使用方法——原生方式</h2>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ajax = <span class="keyword">new</span> XMLHttpRequest();                  <span class="comment">// IE6不能用这个方式，不管它了</span></div><div class="line">ajax.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span>(ajax.readyState==<span class="number">4</span> &amp;&amp; ajax.status==<span class="number">200</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="comment">// do something with ajax.responseText</span></div><div class="line">        <span class="comment">// 还有一个ajax.responseXML, 也不管它了，json大法好</span></div><div class="line">        alert(ajax.responseText);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">ajax.open(<span class="string">"GET"</span>, <span class="string">"./get?var1=val1&amp;var2=val2"</span>, <span class="literal">true</span>);     <span class="comment">// 异步方式运行</span></div><div class="line">ajax.send();</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ajax = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">ajax.open(<span class="string">"POST"</span>, <span class="string">"./post"</span>, <span class="literal">false</span>);                      <span class="comment">// 同步方式运行</span></div><div class="line">ajax.setRequestHeader(<span class="string">"Content-type"</span>,<span class="string">"application/x-www-form-urlencoded"</span>);</div><div class="line">ajax.send(<span class="string">"var1=val1&amp;var2=val2"</span>);</div><div class="line"><span class="comment">// do something with ajax.responseText</span></div><div class="line">alert(ajax.responseText);</div></pre></td></tr></table></figure>
<h2 id="33-jquery-ajax">3.3 原生的好麻烦！——jQuery Ajax</h2>
<p><a href="http://jquery.com/" target="_blank" rel="external">jQuery</a>，棒棒的前端库，不多说。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// $.get(URL, callback)</span></div><div class="line">$.get(<span class="string">"./get?var1=val1&amp;var2=val2"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data, status</span>) </span>&#123;</div><div class="line">        <span class="comment">// do something with data &amp; status</span></div><div class="line">    &#125;);</div><div class="line"><span class="comment">// $.post(URL,data,callback)</span></div><div class="line">$.post(<span class="string">"./post"</span>, &#123;</div><div class="line">        <span class="attr">var1</span>: <span class="string">"val1"</span>,</div><div class="line">        <span class="attr">var2</span>: <span class="string">"val2"</span></div><div class="line">    &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">data, status</span>) </span>&#123;</div><div class="line">        <span class="comment">// do something with data &amp; status</span></div><div class="line">    &#125;);</div><div class="line"><span class="comment">// $.getJSON(url, data, success(data,status,xhr))</span></div><div class="line"><span class="comment">// data和回调函数success可选</span></div><div class="line"><span class="comment">// success中，data参数必需，其它可选</span></div><div class="line">$.getJSON(<span class="string">"./get"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">        <span class="comment">// do something with data</span></div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<h1 id="4">4. 附带的小零碎</h1>
<p><code>window.setInterval(getData, time);</code>用于实现轮询。</p>
<h1 id="5">5. 总结 &amp; 后记</h1>
<p>Ajax简单实用功能强大应用广泛，通过简单的步骤实现前后端的数据交换，来实现网页的动态加载。<br>
开学到现在感觉一直不在状态（实在是想吐槽自己的一群神一样的舍友），今天找了个安静的、没人打扰的地方认认真真写了写代码，总结了一下自己到现在所学的知识才发现自己学的东西是如此零散、不成体系，仿佛从大一开始就在乱点技能点。这一年要多深入学习一个特定方面的知识（暂定后端开发），多写代码积累经验，不能再东学一点西学一点了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前自己没怎么写过前端，一直以为Ajax写起来很麻烦，也没怎么接触Ajax，今天写了个小网页用到了Ajax，感觉它并不是想象的那么复杂，写完网页随手总结一下。（喂我这个技能点是不是点的太晚了啊！）&lt;/p&gt;
    
    </summary>
    
      <category term="网络" scheme="//blog.stdioa.com/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
      <category term="Ajax" scheme="//blog.stdioa.com/tags/Ajax/"/>
    
      <category term="前端开发" scheme="//blog.stdioa.com/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>在Windows中使用Wget</title>
    <link href="//blog.stdioa.com/2015/09/using-wget-in-Windows/"/>
    <id>//blog.stdioa.com/2015/09/using-wget-in-Windows/</id>
    <published>2015-09-18T12:07:00.000Z</published>
    <updated>2016-11-08T13:48:35.551Z</updated>
    
    <content type="html"><![CDATA[<p>一直心心念念想在Windows里用wget，今天随便搞了搞，在Windows里面用上了wget，终于可以下载一些乱七八糟的小文件辣。</p>
<a id="more"></a>
<h1 id="1">1. 引子</h1>
<p>一直觉得Windows里面应该有一个类似wget的工具。今天想从github上下一个文件，结果文件直接以文本方式返回了(响应头的Content-Type为text/plain而不是application神马的)，自己很怨念，觉得要是Windows能像linux一样有个用来wget神马的下载文件的命令就好了…所以自己上网搜了一下，让自己用上了wget.</p>
<h1 id="2">2. 乱搞</h1>
<p>随便百度，找到一篇博文，又找到了一个叫做GnuWin(<a href="http://sourceforge.net/projects/gnuwin32/" target="_blank" rel="external">http://sourceforge.net/projects/gnuwin32/</a>)的项目，该项目主要提供Windows下的GNU工具，比如sed, grep, wget等等。于是下载安装，安装程序默认将程序安装在了C:\Program Files (x86)\GnuWin32\bin目录下。然而即使这样，我还是无法直接在命令行里使用。</p>
<p>Windows中有一个“PATH环境变量”，将某目录（比如C:\Python27）添加进PATH环境变量中，就可以直接在命令行中输入命令打开该目录下的文件。如果想在命令行中使用wget的话，把C:\Program Files (x86)\GnuWin32\bin目录添加进PATH变量中当然可行。但是这样的话，随着工具越来越多，PATH变量里面的路径也就越来越多，维护起来也会更加困难，所以自己使用了一种特殊的方法：在C盘的目录下建了一个Command_line_programs文件夹用来放一些自己常用的命令行工具（比如sqlite），然后将C:\Command_line_programs（以下简称C.L.P.）添加到PATH变量中，这样自己就能使用C.L.P.文件夹中的工具。可是，自己已经将程序安装到Program Files里了，所以需要想个办法在C.L.P.文件中新建一个文件来连接到wget程序。_经过尝试，使用快捷方式的方法失败了。_所以自己想到了<strong>新建批处理文件</strong>。于是在C.L.P.文件夹中新建wget.bat, 内容为<code>C:\&quot;Program Files (x86)&quot;\GnuWin32\bin\wget.exe %*</code> （<code>%*</code>表示在命令中嵌入程序所有参数，详情请百度或Google Windows批处理编程），保存，在命令行中尝试使用wget，成功。</p>
<h1 id="3">3. 然而这并没有什么卵用啊！</h1>
<p>自己搞完以后，盯着GnuWin这几个字，突然想到了git里面自带了很多GNU工具可以直接使用，于是就去git/bin的目录翻了翻，果然，里面没有wget，然而我看到了curl。然后…就没有然后了。<img src="/pics/hands_up_crying.jpg" alt=""></p>
<h1 id="4">4. 后记</h1>
<p>这篇文章是胡乱凑数的，最近学习兴趣不高，又有一堆乱七八糟的事情要忙，所以托更了好久T^T
好了好了要好好学习，说好了多去体验框架呢QAQ</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一直心心念念想在Windows里用wget，今天随便搞了搞，在Windows里面用上了wget，终于可以下载一些乱七八糟的小文件辣。&lt;/p&gt;
    
    </summary>
    
      <category term="乱七八糟" scheme="//blog.stdioa.com/categories/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F/"/>
    
    
      <category term="Windows" scheme="//blog.stdioa.com/tags/Windows/"/>
    
      <category term="wget" scheme="//blog.stdioa.com/tags/wget/"/>
    
  </entry>
  
</feed>
