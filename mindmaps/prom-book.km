{"root":{"children":[{"children":[{"children":[],"data":{"created":1541338068496,"id":"bpkmqthxhpc0","text":"用途：监控"}},{"children":[{"children":[],"data":{"created":1541338092250,"id":"bpkmr4eri2g0","text":"Promtheus Server"}},{"children":[],"data":{"created":1541338810090,"id":"bpkn0a6j5kg0","text":"PushGateway"}},{"children":[],"data":{"created":1541338815593,"id":"bpkn0cpj83k0","text":"AlertManager"}}],"data":{"created":1541338086050,"id":"bpkmr1k8oy80","text":"架构"}},{"children":[{"children":[],"data":{"created":1541338825153,"id":"bpkn0h3n21c0","text":"直接获取"}},{"children":[],"data":{"created":1541338829291,"id":"bpkn0j033xs0","text":"实例主动推送至 PushGateway，Server 通过 Gateway 获取"}}],"data":{"created":1541338088826,"id":"bpkmr2u4weo0","text":"获取指标的方式"}},{"children":[{"children":[],"data":{"created":1541338874014,"id":"bpkn13jpmi80","text":"Counter"}},{"children":[],"data":{"created":1541338877249,"id":"bpkn1517zu80","text":"Gauge"}},{"children":[],"data":{"created":1541338879667,"id":"bpkn1657p2w0","text":"Summary"}},{"children":[],"data":{"created":1541338885762,"id":"bpkn18y0jsg0","text":"Histogram"}}],"data":{"created":1541338867307,"id":"bpkn10gsjbk0","text":"指标数据类型"}}],"data":{"created":1541338051371,"id":"bpkmqlmp8t40","text":"1. 简介"}},{"children":[{"children":[{"children":[],"data":{"created":1541426651764,"id":"bpli5837ydc0","text":"时间序列"}},{"children":[{"children":[{"children":[],"data":{"created":1541426691432,"id":"bpli5qb8xfk0","text":"指标名"}},{"children":[],"data":{"created":1541426698135,"id":"bpli5te3y1c0","text":"标签组"}}],"data":{"created":1541426663700,"id":"bpli5dkmbzs0","text":"指标"}},{"children":[],"data":{"created":1541426667622,"id":"bpli5fdhga00","text":"时间戳"}},{"children":[],"data":{"created":1541426669664,"id":"bpli5gb94340","text":"样本值"}}],"data":{"created":1541426659159,"id":"bpli5bhir0g0","text":"样本"}},{"children":[{"children":[],"data":{"created":1541426730188,"id":"bpli68475tk0","text":"Counter"}},{"children":[],"data":{"created":1541426732921,"id":"bpli69deeh40","text":"Gauge"}},{"children":[],"data":{"created":1541426735391,"id":"bpli6ai9dww0","text":"Summary"}},{"children":[],"data":{"created":1541426737303,"id":"bpli6bdvmvc0","text":"Histogram"}}],"data":{"created":1541426713753,"id":"bpli60kecqo0","text":"指标数据结构"}},{"children":[{"children":[],"data":{"created":1541426750599,"id":"bpli6hhre8o0","text":"数字字面量"}},{"children":[],"data":{"created":1541426754463,"id":"bpli6j9oga00","text":"字符串字面量"}},{"children":[],"data":{"created":1541426760680,"id":"bpli6m4hv3c0","text":"瞬时向量"}},{"children":[],"data":{"created":1541426766735,"id":"bpli6owmcds0","text":"区间向量"}}],"data":{"created":1541426744392,"id":"bpli6en3vaw0","text":"查询数据结构"}}],"data":{"created":1541426645916,"id":"bpli55ei2fs0","text":"基本概念"}},{"children":[{"children":[{"children":[],"data":{"created":1541426815200,"id":"bpli7b65bvc0","text":"指标名"}},{"children":[],"data":{"created":1541426827471,"id":"bpli7gt3egg0","text":"筛选标签"}},{"children":[],"data":{"created":1541426831840,"id":"bpli7itcfsg0","text":"运算函数"}},{"children":[],"data":{"created":1541426833815,"id":"bpli7jq0am00","text":"聚合函数"}}],"data":{"created":1541426807760,"id":"bpli77r3m340","text":"查询语句构成"}},{"children":[{"children":[{"children":[],"data":{"created":1541426871704,"id":"bpli814mbm00","text":"a + b"}}],"data":{"created":1541426847066,"id":"bpli7pt5oxs0","text":"数学运算"}},{"children":[{"children":[],"data":{"created":1541426863809,"id":"bpli7xi1z6w0","text":"a > b"}},{"children":[],"data":{"created":1541426867126,"id":"bpli7z0wmy80","text":"a > bool b"}}],"data":{"created":1541426858168,"id":"bpli7uwrpog0","text":"条件运算"}},{"children":[{"children":[],"data":{"created":1541426885049,"id":"bpli879b0nk0","text":"a and b"}}],"data":{"created":1541426876095,"id":"bpli8358vhs0","text":"集合运算"}},{"children":[{"children":[],"data":{"created":1541426918259,"id":"bpli8mijs280","text":"多对多"}},{"children":[],"data":{"created":1541426921622,"id":"bpli8o2635c0","text":"一对一"}}],"data":{"created":1541426915575,"id":"bpli8la5wcw0","note":"此处的“一”和“多”为向量基数，并不是指向量中每个指标的点的数量","text":"向量匹配"}},{"children":[{"children":[],"data":{"created":1541426987642,"id":"bpli9ie0zww0","text":"by"}},{"children":[],"data":{"created":1541426989591,"id":"bpli9ja9dhk0","text":"without"}}],"data":{"created":1541426895574,"id":"bpli8c3dx2w0","text":"聚合操作"}},{"children":[{"children":[],"data":{"created":1541427000863,"id":"bpli9ogoe7k0","text":"sum"}},{"children":[],"data":{"created":1541427005024,"id":"bpli9qdhrc80","text":"irate"}},{"children":[],"data":{"created":1541427032495,"id":"bplia2ztgc80","text":"histogram_quantile"}},{"children":[],"data":{"created":1541427009167,"id":"bpli9sa05xs0","text":"..."}}],"data":{"created":1541426993311,"id":"bpli9kzs31c0","text":"内置聚合函数"}}],"data":{"created":1541426838184,"id":"bpli7lq9rd40","text":"运算类型"}},{"children":[{"children":[],"data":{"created":1541427026482,"id":"bplia08d1540","text":"在多层设计指标以实现更全面的监控"}},{"children":[{"children":[],"data":{"created":1541427106268,"id":"bplib0vvuds0","text":"黄金指标：延迟、通讯量、错误率、饱和度"}},{"children":[],"data":{"created":1541427132968,"id":"bplibd5g1740","text":"RED：请求速率、错误响应速率、请求耗时"}},{"children":[],"data":{"created":1541427175688,"id":"bplibwryq5k0","text":"USE：使用率、饱和度、错误计数"}}],"data":{"created":1541427101383,"id":"bpliayn3go80","text":"设计模式"}}],"data":{"created":1541427020791,"id":"bpli9xm90bk0","text":"指标设计实践"}}],"data":{"created":1541426800831,"id":"bpli74kibe80","text":"PromQL 查询"}}],"data":{"created":1541338894034,"id":"bpkn1cqt8o00","priority":null,"text":"2. PromQL"}},{"children":[{"children":[{"children":[],"data":{"created":1541946313003,"id":"bpqmcl60icg0","text":"告警来源：Prometheus Server"}},{"children":[],"data":{"created":1541946323838,"id":"bpqmcq56wzc0","text":"具体告警处理：Alertmanager"}}],"data":{"created":1541946297485,"id":"bpqmce1d0q80","text":"基本概念"}},{"children":[{"children":[],"data":{"created":1541946350477,"id":"bpqmd2dr0so0","text":"rule_files 指定告警规则文件"}},{"children":[],"data":{"created":1541946369371,"id":"bpqmdb284ao0","text":"global.evaluation_interval 指定告警监控粒度"}},{"children":[{"children":[],"data":{"created":1541946421084,"id":"bpqmdytgzjc0","text":"组名"}},{"children":[],"data":{"created":1541946429547,"id":"bpqme2pfokw0","text":"告警名称"}},{"children":[],"data":{"created":1541946424181,"id":"bpqme08oviw0","text":"规则表达式"}},{"children":[],"data":{"created":1541946436003,"id":"bpqme5o752o0","text":"标签"}},{"children":[],"data":{"created":1541946443056,"id":"bpqme8wuesg0","text":"注解（支持模板化）"}}],"data":{"created":1541946378141,"id":"bpqmdf3a1a80","text":"规则定义"}}],"data":{"created":1541946334014,"id":"bpqmcuthgg80","text":"告警规则定义"}},{"children":[{"children":[{"children":[],"data":{"created":1541946521891,"id":"bpqmf94mi5c0","text":"树状结构的路由规则"}},{"children":[],"data":{"created":1541946562772,"id":"bpqmfrwq1yw0","text":"支持对告警名称和标签进行匹配"}},{"children":[],"data":{"created":1541946618083,"id":"bpqmghbh5zk0","text":"根据特定标签进行分组，以组为单位配置告警消息的推送间隔"}}],"data":{"created":1541946473457,"id":"bpqmemvmewg0","text":"路由"}},{"children":[{"children":[],"data":{"created":1541946486241,"id":"bpqmesr1itc0","text":"Email"}},{"children":[],"data":{"created":1541946490212,"id":"bpqmeukpzds0","text":"Slack"}},{"children":[],"data":{"created":1541946496739,"id":"bpqmexko1w00","text":"Webhook 集成：钉钉等"}}],"data":{"created":1541946483563,"id":"bpqmerire2w0","text":"接收器"}},{"children":[{"children":[],"data":{"created":1541946746627,"id":"bpqmi4dcuz40","text":"抑制：一种报警发生时，可以抑制其它报警的消息推送"}},{"children":[],"data":{"created":1541946779892,"id":"bpqmijnhvjc0","text":"静默：临时屏蔽某种报警的消息推送"}}],"data":{"created":1541946730964,"id":"bpqmhx6b8qg0","text":"抑制 / 静默机制"}}],"data":{"created":1541946462427,"id":"bpqmeht7cm80","text":"告警处理：Alertmanager"}}],"data":{"created":1541946288545,"id":"bpqmc9xiuw00","text":"3. 告警处理"}},{"children":[{"children":[{"children":[],"data":{"created":1541946841493,"id":"bpqmjby9a5c0","text":"可以向 Prometheus Server 提供监控指标的程序都可以称为 Exporter"}},{"children":[],"data":{"created":1541946864092,"id":"bpqmjmc01i00","text":"指标通过 HTTP API 来提供"}},{"children":[{"children":[],"data":{"created":1541946880964,"id":"bpqmju31ffc0","text":"# HELP 帮助消息"}},{"children":[],"data":{"created":1541946890103,"id":"bpqmjya6zhs0","text":"# TYPE <指标名> <类型>"}},{"children":[],"data":{"created":1541946912483,"id":"bpqmk8kb8iw0","text":"<指标名>{<标签>} <当前值>"}},{"children":[],"data":{"created":1541946943595,"id":"bpqmkmuukpk0","text":"复合指标（Gauge 和 Histogram）会提供多列指标"}}],"data":{"created":1541946877645,"id":"bpqmjsk5hqo0","text":"内容规范"}}],"data":{"created":1541946821435,"id":"bpqmj2qjmgw0","text":"基本概念"}},{"children":[{"children":[{"children":[],"data":{"created":1541947011547,"id":"bpqmli2nkjc0","text":"cAdvisor"}},{"children":[],"data":{"created":1541947015691,"id":"bpqmljz6g6w0","text":"MySQLDExporter"}},{"children":[],"data":{"created":1541947041907,"id":"bpqmlw0qzs00","text":"etc."}}],"data":{"created":1541947002116,"id":"bpqmldqob8g0","text":"独立运行的 Exporter"}},{"children":[{"children":[],"data":{"created":1541947024601,"id":"bpqmlo2jgw00","text":"使用特定语言的 client，在业务中进行集成"}}],"data":{"created":1541947020068,"id":"bpqmllzkhg80","text":"Exporter 集成"}}],"data":{"created":1541946996139,"id":"bpqmlaztzz40","text":"Exporter 举例"}}],"data":{"created":1541946809371,"id":"bpqmix70ytk0","text":"4. Exporter"}},{"children":[{"children":[{"children":[],"data":{"created":1541947059606,"id":"bpqmm45gbcw0","text":"Prometheus 自带 Console Template：难用"}},{"children":[],"data":{"created":1541947069315,"id":"bpqmm8m13hc0","text":"Grafana：对 Prometheus 提供完整支持"}}],"data":{"created":1541947102074,"expandState":"expand","id":"bpqmmnnsjjs0","text":"基本概念"}},{"children":[{"children":[{"children":[],"data":{"created":1541947121181,"id":"bpqmmwfsf9k0","text":"Data Source"}},{"children":[],"data":{"created":1541947126331,"id":"bpqmmysykhk0","text":"Dashboard"}},{"children":[],"data":{"created":1541947129277,"id":"bpqmn05oiy00","text":"Row"}},{"children":[],"data":{"created":1541947133003,"id":"bpqmn1vav880","text":"Panel"}}],"data":{"created":1541947137723,"expandState":"expand","id":"bpqmn41cz6o0","text":"Grafana 概念"}},{"children":[{"children":[],"data":{"created":1541947154977,"id":"bpqmnbypyzk0","text":"Singlestat 用于当前状态监测"}},{"children":[{"children":[],"data":{"created":1541947195451,"id":"bpqmnuk36sg0","text":"可以用一条语句绘制多张图"}}],"data":{"created":1541947164345,"id":"bpqmng9n2u80","text":"Graph 用于观测时间变化"}}],"data":{"created":1541947145596,"id":"bpqmn7nkohc0","text":"创建 Panel"}}],"data":{"created":1541947110403,"id":"bpqmmrhjcvs0","text":"搭建 Grafana Dashboard"}}],"data":{"created":1541947052196,"id":"bpqmm0qwxhc0","text":"5. 指标可视化"}},{"children":[{"children":[{"children":[{"children":[],"data":{"created":1542204910198,"id":"bpt60j2tb2o0","text":"本地存储：将数据按时间段分片存储"}},{"children":[],"data":{"created":1542204968118,"id":"bpt619opg7k0","text":"远程存储：Prometheus 提供存储标准接口，外挂适配器可以将数据存储至第三方，实现持久化"}}],"data":{"created":1542204903647,"id":"bpt60g2h6so0","text":"文件存储"}},{"children":[{"children":[],"data":{"created":1542205030214,"id":"bpt6227nzfk0","text":"联邦集群：在多个数据中心部署多个 Prometheus Server，中心 Server 通过 API 来从其它 Server 聚合数据"}},{"children":[],"data":{"created":1542205093508,"id":"bpt62vafbio0","text":"功能分区：在同一集群中部署多个 Prometheus Server，用来执行不同的数据采集任务，然后再交由中心 Server 进行聚合"}}],"data":{"created":1542205021045,"id":"bpt61y00wew0","text":"部署架构"}}],"data":{"created":1542204774533,"id":"bpt5ysr66wo0","text":"Prometheus 架构"}},{"children":[{"children":[{"children":[],"data":{"created":1542205195340,"id":"bpt6462jdu00","text":"服务可用性：主备 HA"}},{"children":[],"data":{"created":1542205212182,"id":"bpt64dt2n2o0","text":"数据持久化：远程存储"}},{"children":[],"data":{"created":1542205219014,"id":"bpt64gy2als0","text":"水平扩展：联邦集群"}}],"data":{"created":1542205146925,"id":"bpt63jtubm00","text":"Prom Server 高可用"}},{"children":[{"children":[],"data":{"created":1542205227077,"id":"bpt64knergw0","text":"Gossip 机制保证多个 Alertmanager 存在时，只发送一份报警消息"}}],"data":{"created":1542205152014,"id":"bpt63m60bts0","text":"Alertmanager 高可用"}}],"data":{"created":1542205142141,"id":"bpt63hmq5kw0","text":"Prometheus 高可用方案"}}],"data":{"created":1541947054451,"id":"bpqmm1s74io0","text":"6. 集群与高可用"}},{"children":[{"children":[{"children":[],"data":{"created":1542205322957,"id":"bpt65sp36so0","text":"Prometheus 通过访问一个固定的注册中心来获取所有实例地址，然后依次抓取样本"}}],"data":{"created":1542205299981,"id":"bpt65i5442w0","text":"服务发现"}},{"children":[{"children":[],"data":{"created":1542205375886,"id":"bpt66h0g8ns0","text":"对元数据标签加以利用"}},{"children":[],"data":{"created":1542205402372,"id":"bpt66t6gujk0","text":"更改标签名称"}},{"children":[],"data":{"created":1542205407772,"id":"bpt66vns9oo0","text":"对标签进行过滤"}},{"children":[],"data":{"created":1542205421305,"id":"bpt671vla6w0","text":"对标签进行 hash 以完成功能分区"}}],"data":{"created":1542205368262,"id":"bpt66diczc00","text":"Relabeling 机制"}}],"data":{"created":1541947233155,"id":"bpqmobvmwfc0","text":"7. Prometheus 服务发现"}},{"children":[{"children":[{"children":[],"data":{"created":1542205445527,"id":"bpt67d06fa00","text":"Node"}},{"children":[],"data":{"created":1542205451775,"id":"bpt67fvim5c0","text":"Container"}},{"children":[],"data":{"created":1542205454615,"id":"bpt67h6h5m00","text":"Pod"}},{"children":[],"data":{"created":1542205459627,"id":"bpt67jhdea00","text":"k8s 组件"}},{"children":[],"data":{"created":1542205464927,"id":"bpt67lx0krk0","text":"Service"}},{"children":[],"data":{"created":1542205467805,"id":"bpt67n8m9vs0","text":"Ingress"}}],"data":{"created":1542205438604,"id":"bpt679togjc0","text":"Kubernetes 监控指标"}},{"children":[{"children":[],"data":{"created":1542205617501,"id":"bpt69k0bew80","text":"ConfigMap 注入配置文件，Deployment 部署 Server"}},{"children":[],"data":{"created":1542205745846,"id":"bpt6b6ywi3k0","text":"通过 k8s API 完成服务发现"}},{"children":[],"data":{"created":1542205793561,"id":"bpt6bsw0tjk0","text":"通过 relabeling 机制筛选出暴露指标的 pod，避免无效抓取"}}],"data":{"created":1542205598709,"id":"bpt69bdiu7s0","text":"在 Kubernetes 集群中部署 Prometheus"}}],"data":{"created":1541947237883,"id":"bpqmoe1tq280","text":"8. 监控 Kubernetes"}}],"data":{"created":1541338015661,"id":"bpkmq584psw0","text":"Prometheus Book"}},"template":"default","theme":"classic","version":"1.4.25"}